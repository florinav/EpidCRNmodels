(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     41710,       1004]
NotebookOptionsPosition[     39631,        969]
NotebookOutlinePosition[     40073,        985]
CellTagsIndexPosition[     40030,        982]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"===", 
    RowBox[{"=", 
     RowBox[{
      RowBox[{"DSR", ":", 
       RowBox[{
        RowBox[{
         RowBox[{"Directed", " ", "Species"}], "-", 
         RowBox[{"Reaction", " ", "Graph"}]}], "==="}]}], "="}]}]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"DSR", "::", "usage"}], "=", 
     "\"\<DSR[RN] builds the directed species-reaction (SR) bipartite graph \
for reaction network RN.\nReturns an association with keys:\n  \\\"Graph\\\" \
-> the Graph object with signed, stoichiometric edge labels\n  \\\"EdgeData\\\
\" -> list of associations {<|\\\"edge\\\"->_, \\\"sign\\\"->_, \
\\\"stoich\\\"->_|>, ...}\n  \\\"ReactionNodes\\\" -> list of reaction node \
labels {\\\"R1\\\", \\\"R2\\\", ...}\n  \\\"SpeciesNodes\\\" -> list of \
species node labels\>\""}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"DSR", "[", "RN_List", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "snodes", ",", "rnodes", ",", "vertices", ",", "edges", ",", 
         "edgeLabels", ",", "parsedRN", ",", "rComp", ",", "pComp", ",", 
         "rSpecies", ",", "pSpecies", ",", "DSRGraph", ",", "DSRresult"}], 
        "}"}], ",", 
       RowBox[{"(*", 
        RowBox[{"Species", " ", "nodes"}], "*)"}], 
       RowBox[{
        RowBox[{"snodes", "=", 
         RowBox[{"extSpe", "[", "RN", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Reaction", " ", "nodes"}], "*)"}], 
        RowBox[{"rnodes", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"\"\<R\>\"", "<>", 
            RowBox[{"ToString", "[", "i", "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "RN", "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"All", " ", "vertices"}], "*)"}], 
        RowBox[{"vertices", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"snodes", ",", "rnodes"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Parse", " ", "each", " ", "reaction"}], "*)"}], 
        RowBox[{"parsedRN", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"rComp", "=", 
             RowBox[{"parseComplex", "[", 
              RowBox[{"RN", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"pComp", "=", 
             RowBox[{"parseComplex", "[", 
              RowBox[{"RN", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"rSpecies", "=", 
             RowBox[{"Keys", "[", "rComp", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"pSpecies", "=", 
             RowBox[{"Keys", "[", "pComp", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
             "i", ",", "rComp", ",", "pComp", ",", "rSpecies", ",", 
              "pSpecies"}], "}"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "RN", "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Build", " ", "edges", " ", "and", " ", "labels"}], "*)"}], 
        RowBox[{"edges", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"edgeLabels", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"rxnNode", "=", 
               RowBox[{"rnodes", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], ",", 
              RowBox[{"rComp", "=", 
               RowBox[{"parsedRN", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ",", 
              RowBox[{"pComp", "=", 
               RowBox[{"parsedRN", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "3"}], "]"}], "]"}]}], ",", 
              RowBox[{"rSpecies", "=", 
               RowBox[{"parsedRN", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "4"}], "]"}], "]"}]}], ",", 
              RowBox[{"pSpecies", "=", 
               RowBox[{"parsedRN", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "5"}], "]"}], "]"}]}]}], "}"}], ",", 
            RowBox[{"(*", 
             RowBox[{"Reactant", "->", 
              RowBox[{"Reaction", " ", "edges", " ", 
               RowBox[{"(", 
                RowBox[{"sign", "=", 
                 RowBox[{"-", "1"}]}], ")"}]}]}], "*)"}], 
            RowBox[{
             RowBox[{"Do", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"AppendTo", "[", 
                 RowBox[{"edges", ",", 
                  RowBox[{"s", "->", "rxnNode"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"edgeLabels", ",", 
                  RowBox[{"<|", 
                   RowBox[{
                    RowBox[{"\"\<edge\>\"", "->", 
                    RowBox[{"(", 
                    RowBox[{"s", "->", "rxnNode"}], ")"}]}], ",", 
                    RowBox[{"\"\<sign\>\"", "->", 
                    RowBox[{"-", "1"}]}], ",", 
                    RowBox[{"\"\<stoich\>\"", "->", 
                    RowBox[{"rComp", "[", "s", "]"}]}]}], "|>"}]}], "]"}]}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"s", ",", "rSpecies"}], "}"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"Reaction", "->", 
               RowBox[{"Product", " ", "edges", " ", 
                RowBox[{"(", 
                 RowBox[{"sign", "=", 
                  RowBox[{"+", "1"}]}], ")"}]}]}], "*)"}], 
             RowBox[{"Do", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"AppendTo", "[", 
                 RowBox[{"edges", ",", 
                  RowBox[{"rxnNode", "->", "s"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"edgeLabels", ",", 
                  RowBox[{"<|", 
                   RowBox[{
                    RowBox[{"\"\<edge\>\"", "->", 
                    RowBox[{"(", 
                    RowBox[{"rxnNode", "->", "s"}], ")"}]}], ",", 
                    RowBox[{"\"\<sign\>\"", "->", "1"}], ",", 
                    RowBox[{"\"\<stoich\>\"", "->", 
                    RowBox[{"pComp", "[", "s", "]"}]}]}], "|>"}]}], "]"}]}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"s", ",", "pSpecies"}], "}"}]}], "]"}], ";"}]}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "RN", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Convert", " ", "edge", " ", "labels", " ", "to", " ", "rules", " ", 
          "for", " ", "EdgeLabels", " ", "option"}], "*)"}], 
        RowBox[{"edgeLabelRules", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", "\"\<edge\>\"", "]"}], "&"}], "/@", 
             "edgeLabels"}], ")"}], "->", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"#", "[", "\"\<sign\>\"", "]"}], "/.", " ", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"1", "->", "\"\<+\>\""}], ",", 
                   RowBox[{
                    RowBox[{"-", "1"}], "->", "\"\<-\>\""}]}], "}"}]}], ")"}],
                "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"#", "[", "\"\<stoich\>\"", "]"}], "]"}]}], "&"}], "/@",
              "edgeLabels"}], ")"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Graph", " ", "construction"}], "*)"}], 
        RowBox[{"DSRGraph", "=", 
         RowBox[{"Graph", "[", 
          RowBox[{"vertices", ",", "edges", ",", 
           RowBox[{"VertexLabels", "->", 
            RowBox[{"Placed", "[", 
             RowBox[{"Automatic", ",", "Center"}], "]"}]}], ",", 
           RowBox[{"EdgeLabels", "->", "edgeLabelRules"}], ",", 
           RowBox[{"VertexShapeFunction", "->", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"StringMatchQ", "[", 
                 RowBox[{
                  RowBox[{"ToString", "[", "#2", "]"}], ",", 
                  RowBox[{"\"\<R\>\"", "~~", "__"}]}], "]"}], ",", 
                "\"\<Square\>\"", ",", "\"\<Circle\>\""}], "]"}], "&"}], 
             ")"}]}], ",", 
           RowBox[{"ImagePadding", "->", "10"}], ",", 
           RowBox[{"GraphLayout", "->", "\"\<LayeredDigraphEmbedding\>\""}], 
           ",", 
           RowBox[{"DirectedEdges", "->", "True"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"DSRresult", "=", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<Graph\>\"", "->", "DSRGraph"}], ",", 
           RowBox[{"\"\<EdgeData\>\"", "->", "edgeLabels"}], ",", 
           RowBox[{"\"\<ReactionNodes\>\"", "->", "rnodes"}], ",", 
           RowBox[{"\"\<SpeciesNodes\>\"", "->", "snodes"}]}], "|>"}]}], ";", 
        "\[IndentingNewLine]", "DSRresult"}]}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", "Test"}]}], " ", 
     RowBox[{
      RowBox[{"parseComplex", "--"}], "--"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<=== Testing parseComplex ===\>\"", "]"}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<parseComplex[0] = \>\"", ",", 
      RowBox[{"parseComplex", "[", "0", "]"}]}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<parseComplex[\\\"A\\\"] = \>\"", ",", 
      RowBox[{"parseComplex", "[", "\"\<A\>\"", "]"}]}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<parseComplex[\\\"A\\\" + \\\"B\\\"] = \>\"", ",", 
      RowBox[{"parseComplex", "[", 
       RowBox[{"\"\<A\>\"", "+", "\"\<B\>\""}], "]"}]}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<parseComplex[2*\\\"C\\\"] = \>\"", ",", 
      RowBox[{"parseComplex", "[", 
       RowBox[{"2", "*", "\"\<C\>\""}], "]"}]}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<parseComplex[\\\"A\\\" + 2*\\\"B\\\" + 3*\\\"C\\\"] = \>\"", ",", 
      RowBox[{"parseComplex", "[", 
       RowBox[{"\"\<A\>\"", "+", 
        RowBox[{"2", "*", "\"\<B\>\""}], "+", 
        RowBox[{"3", "*", "\"\<C\>\""}]}], "]"}]}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", "]"}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", "test"}]}], " ", "DSR", " ", 
     RowBox[{
      RowBox[{"example", "--"}], "--"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<=== Testing DSR ===\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "small", " ", "RN", " ", "where", " ", "RN", " ", "must", " ", "be", " ", 
     "a", " ", "list", " ", "of", " ", "rules", " ", 
     RowBox[{"{", 
      RowBox[{"lhs", "->", "rhs"}], "}"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"RN", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"\"\<A\>\"", "+", "\"\<B\>\""}], "->", "\"\<C\>\""}], ",", 
       RowBox[{
        RowBox[{"2", "*", "\"\<C\>\""}], "->", 
        RowBox[{"\"\<A\>\"", "+", "\"\<B\>\""}]}], ",", 
       RowBox[{"0", "->", "\"\<A\>\""}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"DSRresult", "=", 
     RowBox[{"DSR", "[", "RN", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"DSRGraph", "=", 
     RowBox[{"DSRresult", "[", "\"\<Graph\>\"", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Species nodes: \>\"", ",", 
      RowBox[{"DSRresult", "[", "\"\<SpeciesNodes\>\"", "]"}]}], "]"}], ";"}],
    "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Reaction nodes: \>\"", ",", 
      RowBox[{"DSRresult", "[", "\"\<ReactionNodes\>\"", "]"}]}], "]"}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<Edge data: \>\"", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"DSRresult", "[", "\"\<EdgeData\>\"", "]"}], "]"}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{
       RowBox[{"Visualization", "--"}], "--"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<\\n=== Visualizing DSR Graph ===\>\"", "]"}], 
    ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Basic", " ", "visualization"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<Basic view:\>\"", "]"}], ";"}], "\n", 
   "DSRGraph", "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Enhanced", " ", "bipartite", " ", "layout", " ", "visualization"}], "-", 
     RowBox[{"FIXED", " ", "for", " ", "v13", ".3"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<\\nBipartite layout view:\>\"", "]"}], ";"}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Manual", " ", "bipartite", " ", "layout", " ", "for", " ", "Mathematica",
      " ", "13.3"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "species", ",", "reactions", ",", "nSpecies", ",", "nReactions", ",", 
       "vertexCoords"}], "}"}], ",", 
     RowBox[{
      RowBox[{"species", "=", 
       RowBox[{"DSRresult", "[", "\"\<SpeciesNodes\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"reactions", "=", 
       RowBox[{"DSRresult", "[", "\"\<ReactionNodes\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nSpecies", "=", 
       RowBox[{"Length", "[", "species", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nReactions", "=", 
       RowBox[{"Length", "[", "reactions", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Place", " ", "species", " ", "on", " ", "left", " ", "column", " ", 
         RowBox[{"(", 
          RowBox[{"x", "=", "0"}], ")"}]}], ",", 
        RowBox[{"reactions", " ", "on", " ", "right", " ", "column", " ", 
         RowBox[{"(", 
          RowBox[{"x", "=", "2"}], ")"}]}]}], "*)"}], 
      RowBox[{"vertexCoords", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Thread", "[", 
          RowBox[{"species", "->", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "i"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "nSpecies", ",", "1", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], "]"}], ",", 
         RowBox[{"Thread", "[", 
          RowBox[{"reactions", "->", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"2", ",", "i"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "nReactions", ",", "1", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Graph", "[", 
       RowBox[{
        RowBox[{"VertexList", "[", "DSRGraph", "]"}], ",", 
        RowBox[{"EdgeList", "[", "DSRGraph", "]"}], ",", 
        RowBox[{"VertexCoordinates", "->", "vertexCoords"}], ",", 
        RowBox[{"VertexLabels", "->", 
         RowBox[{"Placed", "[", 
          RowBox[{"Automatic", ",", "Center"}], "]"}]}], ",", 
        RowBox[{"VertexSize", "->", "Medium"}], ",", 
        RowBox[{"VertexStyle", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Thread", "[", 
            RowBox[{"species", "->", "LightBlue"}], "]"}], ",", 
           RowBox[{"Thread", "[", 
            RowBox[{"reactions", "->", "LightGreen"}], "]"}]}], "}"}]}], ",", 
        RowBox[{"VertexShapeFunction", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Thread", "[", 
            RowBox[{"species", "->", "\"\<Circle\>\""}], "]"}], ",", 
           RowBox[{"Thread", "[", 
            RowBox[{"reactions", "->", "\"\<Square\>\""}], "]"}]}], "}"}]}], 
        ",", 
        RowBox[{"EdgeLabels", "->", 
         RowBox[{"Thread", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", "\"\<edge\>\"", "]"}], "&"}], "/@", 
             RowBox[{"DSRresult", "[", "\"\<EdgeData\>\"", "]"}]}], ")"}], "->", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"#", "[", "\"\<sign\>\"", "]"}], "/.", " ", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"1", "->", "\"\<+\>\""}], ",", 
                   RowBox[{
                    RowBox[{"-", "1"}], "->", "\"\<-\>\""}]}], "}"}]}], ")"}],
                "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"#", "[", "\"\<stoich\>\"", "]"}], "]"}]}], "&"}], "/@", 
             RowBox[{"DSRresult", "[", "\"\<EdgeData\>\"", "]"}]}], ")"}]}], 
          "]"}]}], ",", 
        RowBox[{"ImageSize", "->", "Large"}], ",", 
        RowBox[{"ImagePadding", "->", "20"}]}], "]"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.969674326889679*^9, 3.969674326890682*^9}},
 CellLabel->
  "In[1032]:=",ExpressionUUID->"738c8143-b87b-45aa-b8a5-0ce1ff986b15"],

Cell[CellGroupData[{

Cell[BoxData["\<\"=== Testing parseComplex ===\"\>"], "Print",
 CellChangeTimes->{3.9696730663527985`*^9, 3.9696738011586246`*^9, 
  3.9696741987716465`*^9, 3.9696743307090397`*^9},
 CellLabel->
  "During evaluation of \
In[1032]:=",ExpressionUUID->"e6e2e171-d7fa-4363-8d30-24fc67e70143"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"parseComplex[0] = \"\>", "\[InvisibleSpace]", 
   RowBox[{"\[LeftAssociation]", "\[RightAssociation]"}]}],
  SequenceForm["parseComplex[0] = ", <||>],
  Editable->False]], "Print",
 CellChangeTimes->{3.9696730663527985`*^9, 3.9696738011586246`*^9, 
  3.9696741987716465`*^9, 3.969674330809147*^9},
 CellLabel->
  "During evaluation of \
In[1032]:=",ExpressionUUID->"6b9e946e-d6cd-4fcb-85ac-5432b0bf45f2"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"parseComplex[\\\"A\\\"] = \"\>", "\[InvisibleSpace]", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{"\<\"A\"\>", "\[Rule]", "1"}], "\[RightAssociation]"}]}],
  SequenceForm["parseComplex[\"A\"] = ", <|"A" -> 1|>],
  Editable->False]], "Print",
 CellChangeTimes->{3.9696730663527985`*^9, 3.9696738011586246`*^9, 
  3.9696741987716465`*^9, 3.9696743309341583`*^9},
 CellLabel->
  "During evaluation of \
In[1032]:=",ExpressionUUID->"734ae270-a9b4-41aa-a5c9-8b7b4409cdcb"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"parseComplex[\\\"A\\\" + \\\"B\\\"] = \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\<\"A\"\>", "\[Rule]", "1"}], ",", 
     RowBox[{"\<\"B\"\>", "\[Rule]", "1"}]}], "\[RightAssociation]"}]}],
  SequenceForm["parseComplex[\"A\" + \"B\"] = ", <|"A" -> 1, "B" -> 1|>],
  Editable->False]], "Print",
 CellChangeTimes->{3.9696730663527985`*^9, 3.9696738011586246`*^9, 
  3.9696741987716465`*^9, 3.9696743310801706`*^9},
 CellLabel->
  "During evaluation of \
In[1032]:=",ExpressionUUID->"780b7ddf-afbe-4866-98f5-c49e98563ace"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"parseComplex[2*\\\"C\\\"] = \"\>", "\[InvisibleSpace]", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{"\<\"C\"\>", "\[Rule]", "2"}], "\[RightAssociation]"}]}],
  SequenceForm["parseComplex[2*\"C\"] = ", <|"C" -> 2|>],
  Editable->False]], "Print",
 CellChangeTimes->{3.9696730663527985`*^9, 3.9696738011586246`*^9, 
  3.9696741987716465`*^9, 3.969674331226348*^9},
 CellLabel->
  "During evaluation of \
In[1032]:=",ExpressionUUID->"1dcb0724-2319-4abd-bb2e-b743258e8766"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"parseComplex[\\\"A\\\" + 2*\\\"B\\\" + 3*\\\"C\\\"] = \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\<\"A\"\>", "\[Rule]", "1"}], ",", 
     RowBox[{"\<\"B\"\>", "\[Rule]", "2"}], ",", 
     RowBox[{"\<\"C\"\>", "\[Rule]", "3"}]}], "\[RightAssociation]"}]}],
  SequenceForm[
  "parseComplex[\"A\" + 2*\"B\" + 3*\"C\"] = ", <|
   "A" -> 1, "B" -> 2, "C" -> 3|>],
  Editable->False]], "Print",
 CellChangeTimes->{3.9696730663527985`*^9, 3.9696738011586246`*^9, 
  3.9696741987716465`*^9, 3.969674331363965*^9},
 CellLabel->
  "During evaluation of \
In[1032]:=",ExpressionUUID->"ffa2dbe5-18a0-4ff8-a743-12a6a0ef5a7b"],

Cell[BoxData["\<\"\"\>"], "Print",
 CellChangeTimes->{3.9696730663527985`*^9, 3.9696738011586246`*^9, 
  3.9696741987716465`*^9, 3.9696743314933434`*^9},
 CellLabel->
  "During evaluation of \
In[1032]:=",ExpressionUUID->"3fd76ca4-efe2-4464-b766-174af661d175"],

Cell[BoxData["\<\"=== Testing DSR ===\"\>"], "Print",
 CellChangeTimes->{3.9696730663527985`*^9, 3.9696738011586246`*^9, 
  3.9696741987716465`*^9, 3.9696743316273003`*^9},
 CellLabel->
  "During evaluation of \
In[1032]:=",ExpressionUUID->"c42d29ad-4631-4b2d-8a8a-566a354f988b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Species nodes: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"\<\"A\"\>", ",", "\<\"B\"\>", ",", "\<\"C\"\>"}], "}"}]}],
  SequenceForm["Species nodes: ", {"A", "B", "C"}],
  Editable->False]], "Print",
 CellChangeTimes->{3.9696730663527985`*^9, 3.9696738011586246`*^9, 
  3.9696741987716465`*^9, 3.969674331749571*^9},
 CellLabel->
  "During evaluation of \
In[1032]:=",ExpressionUUID->"6eae3a72-001f-4762-a2a0-530855e9d002"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reaction nodes: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"\<\"R1\"\>", ",", "\<\"R2\"\>", ",", "\<\"R3\"\>"}], "}"}]}],
  SequenceForm["Reaction nodes: ", {"R1", "R2", "R3"}],
  Editable->False]], "Print",
 CellChangeTimes->{3.9696730663527985`*^9, 3.9696738011586246`*^9, 
  3.9696741987716465`*^9, 3.969674331860834*^9},
 CellLabel->
  "During evaluation of \
In[1032]:=",ExpressionUUID->"b4b78f3d-5976-4d81-95d8-d610e6ffa0d5"],

Cell[BoxData["\<\"Edge data: \"\>"], "Print",
 CellChangeTimes->{3.9696730663527985`*^9, 3.9696738011586246`*^9, 
  3.9696741987716465`*^9, 3.969674331975476*^9},
 CellLabel->
  "During evaluation of \
In[1032]:=",ExpressionUUID->"6fd9fd06-5467-4306-b1b7-24a9be04be38"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\<\"edge\"\>", "\[Rule]", 
      RowBox[{"\<\"A\"\>", "\[Rule]", "\<\"R1\"\>"}]}], ",", 
     RowBox[{"\<\"sign\"\>", "\[Rule]", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{"\<\"stoich\"\>", "\[Rule]", "1"}]}], "\[RightAssociation]"}], 
   ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\<\"edge\"\>", "\[Rule]", 
      RowBox[{"\<\"B\"\>", "\[Rule]", "\<\"R1\"\>"}]}], ",", 
     RowBox[{"\<\"sign\"\>", "\[Rule]", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{"\<\"stoich\"\>", "\[Rule]", "1"}]}], "\[RightAssociation]"}], 
   ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\<\"edge\"\>", "\[Rule]", 
      RowBox[{"\<\"R1\"\>", "\[Rule]", "\<\"C\"\>"}]}], ",", 
     RowBox[{"\<\"sign\"\>", "\[Rule]", "1"}], ",", 
     RowBox[{"\<\"stoich\"\>", "\[Rule]", "1"}]}], "\[RightAssociation]"}], 
   ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\<\"edge\"\>", "\[Rule]", 
      RowBox[{"\<\"C\"\>", "\[Rule]", "\<\"R2\"\>"}]}], ",", 
     RowBox[{"\<\"sign\"\>", "\[Rule]", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{"\<\"stoich\"\>", "\[Rule]", "2"}]}], "\[RightAssociation]"}], 
   ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\<\"edge\"\>", "\[Rule]", 
      RowBox[{"\<\"R2\"\>", "\[Rule]", "\<\"A\"\>"}]}], ",", 
     RowBox[{"\<\"sign\"\>", "\[Rule]", "1"}], ",", 
     RowBox[{"\<\"stoich\"\>", "\[Rule]", "1"}]}], "\[RightAssociation]"}], 
   ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\<\"edge\"\>", "\[Rule]", 
      RowBox[{"\<\"R2\"\>", "\[Rule]", "\<\"B\"\>"}]}], ",", 
     RowBox[{"\<\"sign\"\>", "\[Rule]", "1"}], ",", 
     RowBox[{"\<\"stoich\"\>", "\[Rule]", "1"}]}], "\[RightAssociation]"}], 
   ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\<\"edge\"\>", "\[Rule]", 
      RowBox[{"\<\"R3\"\>", "\[Rule]", "\<\"A\"\>"}]}], ",", 
     RowBox[{"\<\"sign\"\>", "\[Rule]", "1"}], ",", 
     RowBox[{"\<\"stoich\"\>", "\[Rule]", "1"}]}], "\[RightAssociation]"}]}], 
  "}"}]], "Print",
 CellChangeTimes->{3.9696730663527985`*^9, 3.9696738011586246`*^9, 
  3.9696741987716465`*^9, 3.969674332091711*^9},
 CellLabel->
  "During evaluation of \
In[1032]:=",ExpressionUUID->"f7d2266a-74cf-49f0-8ee0-db8d2ab19b41"],

Cell[BoxData["\<\"\\n=== Visualizing DSR Graph ===\"\>"], "Print",
 CellChangeTimes->{3.9696730663527985`*^9, 3.9696738011586246`*^9, 
  3.9696741987716465`*^9, 3.9696743321915035`*^9},
 CellLabel->
  "During evaluation of \
In[1032]:=",ExpressionUUID->"dca5a280-fb5b-4494-aee7-2025cd06c4b8"],

Cell[BoxData["\<\"Basic view:\"\>"], "Print",
 CellChangeTimes->{3.9696730663527985`*^9, 3.9696738011586246`*^9, 
  3.9696741987716465`*^9, 3.969674332310219*^9},
 CellLabel->
  "During evaluation of \
In[1032]:=",ExpressionUUID->"dc7dcae9-b6e0-4b2a-914c-6df972dc4fe3"],

Cell[BoxData["\<\"\\nBipartite layout view:\"\>"], "Print",
 CellChangeTimes->{3.9696730663527985`*^9, 3.9696738011586246`*^9, 
  3.9696741987716465`*^9, 3.9696743326517615`*^9},
 CellLabel->
  "During evaluation of \
In[1032]:=",ExpressionUUID->"24480743-c90c-4222-8efd-351ae201936d"]
}, Open  ]],

Cell[BoxData[
 TagBox[
  DynamicModuleBox[{Typeset`sgraph$$ = 
   Graph[{"A", "B", "C", "R1", "R2", "R3"}, {{{1, 4}, {2, 4}, {4, 3}, {3, 
     5}, {5, 1}, {5, 2}, {6, 1}}, Null}, {
    EdgeLabels -> {
      DirectedEdge["R1", "C"] -> "+1", DirectedEdge["R2", "A"] -> "+1", 
       DirectedEdge["B", "R1"] -> "-1", DirectedEdge["C", "R2"] -> "-2", 
       DirectedEdge["A", "R1"] -> "-1", DirectedEdge["R2", "B"] -> "+1", 
       DirectedEdge["R3", "A"] -> "+1"}, ImagePadding -> 20, ImageSize -> 
     Large, VertexCoordinates -> {{0, 3}, {0, 2}, {0, 1}, {2, 3}, {2, 2}, {2, 
      1}}, VertexLabels -> {
       Placed[Automatic, Center]}, 
     VertexShapeFunction -> {{
       "R1" -> "Square", "R2" -> "Square", "R3" -> "Square"}}, 
     VertexSize -> {Medium}, 
     VertexStyle -> {{
       "R1" -> RGBColor[0.88, 1, 0.88], "R2" -> RGBColor[0.88, 1, 0.88], "R3" -> 
        RGBColor[0.88, 1, 0.88]}}}]}, 
   InterpretationBox[
    RowBox[{
     TagBox["Graph",
      "SummaryHead"], "[", 
     DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
      "Ready"}, 
      TemplateBox[{
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]],
                 ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GraphicsBox[
               
               GraphicsComplexBox[{{
                0.1, -3.31951456589972}, {-0.14816751450286603`, \
-2.625037331552915}, {0.6310524421714278, -1.3}, {
                0.9405108616213151, -2.8841601437046225`}, {
                0.4967448863824806, -2.092358403567382}, {-0.846735323402297, \
-1.466588600696043}, {0.8846460183439665, -0.5107506168284197}, {
                1.8939086566530445`, -2.50980168725566}, {
                1.756629266633539, -3.4622764737192444`}, {
                2.119361963550152, -2.99}, {-0.5709741939515942, \
-4.632295267644082}, {
                0.20977925607671288`, -4.647162049737781}, \
{-1.0861820131541373`, -4.047493574735101}, {-1.2223073729506904`, \
-2.2040562174063485`}}, {
                 Hue[0.6, 0.7, 0.5], 
                 Opacity[0.7], 
                 Arrowheads[0.], 
                 
                 ArrowBox[{{1, 2}, {1, 4}, {1, 11}, {1, 12}, {1, 13}, {2, 
                  3}, {2, 4}, {2, 5}, {2, 6}, {2, 14}, {3, 4}, {3, 7}, {4, 
                  5}, {4, 8}, {4, 9}, {8, 10}, {9, 10}}, 0.0378698213750627], 
                 Hue[0.6, 0.2, 0.8], 
                 EdgeForm[{
                   GrayLevel[0], 
                   Opacity[0.7]}], 
                 DiskBox[1, 0.05], 
                 DiskBox[2, 0.05], 
                 DiskBox[3, 0.05], 
                 DiskBox[4, 0.05], 
                 DiskBox[5, 0.05], 
                 DiskBox[6, 0.05], 
                 DiskBox[7, 0.05], 
                 DiskBox[8, 0.05], 
                 DiskBox[9, 0.05], 
                 DiskBox[10, 0.05], 
                 DiskBox[11, 0.05], 
                 DiskBox[12, 0.05], 
                 DiskBox[13, 0.05], 
                 DiskBox[14, 0.05]}], AspectRatio -> 1, Background -> 
               GrayLevel[0.93], ImagePadding -> 0, FrameStyle -> Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], Frame -> True, 
               FrameTicks -> None, ImageSize -> 
               Dynamic[{
                 Automatic, (3.5 CurrentValue["FontCapHeight"])/
                  AbsoluteCurrentValue[Magnification]}], 
               PlotRange -> {{-1.1, 2.4}, {-4.4, -0.7}}], 
              GridBox[{{
                 RowBox[{
                   TagBox["\"Vertex count: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["6", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Edge count: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["7", "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]],
                 ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GraphicsBox[
               
               GraphicsComplexBox[{{
                0.1, -3.31951456589972}, {-0.14816751450286603`, \
-2.625037331552915}, {0.6310524421714278, -1.3}, {
                0.9405108616213151, -2.8841601437046225`}, {
                0.4967448863824806, -2.092358403567382}, {-0.846735323402297, \
-1.466588600696043}, {0.8846460183439665, -0.5107506168284197}, {
                1.8939086566530445`, -2.50980168725566}, {
                1.756629266633539, -3.4622764737192444`}, {
                2.119361963550152, -2.99}, {-0.5709741939515942, \
-4.632295267644082}, {
                0.20977925607671288`, -4.647162049737781}, \
{-1.0861820131541373`, -4.047493574735101}, {-1.2223073729506904`, \
-2.2040562174063485`}}, {
                 Hue[0.6, 0.7, 0.5], 
                 Opacity[0.7], 
                 Arrowheads[0.], 
                 
                 ArrowBox[{{1, 2}, {1, 4}, {1, 11}, {1, 12}, {1, 13}, {2, 
                  3}, {2, 4}, {2, 5}, {2, 6}, {2, 14}, {3, 4}, {3, 7}, {4, 
                  5}, {4, 8}, {4, 9}, {8, 10}, {9, 10}}, 0.0378698213750627], 
                 Hue[0.6, 0.2, 0.8], 
                 EdgeForm[{
                   GrayLevel[0], 
                   Opacity[0.7]}], 
                 DiskBox[1, 0.05], 
                 DiskBox[2, 0.05], 
                 DiskBox[3, 0.05], 
                 DiskBox[4, 0.05], 
                 DiskBox[5, 0.05], 
                 DiskBox[6, 0.05], 
                 DiskBox[7, 0.05], 
                 DiskBox[8, 0.05], 
                 DiskBox[9, 0.05], 
                 DiskBox[10, 0.05], 
                 DiskBox[11, 0.05], 
                 DiskBox[12, 0.05], 
                 DiskBox[13, 0.05], 
                 DiskBox[14, 0.05]}], AspectRatio -> 1, Background -> 
               GrayLevel[0.93], ImagePadding -> 0, FrameStyle -> Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], Frame -> True, 
               FrameTicks -> None, ImageSize -> 
               Dynamic[{
                 Automatic, (3.5 CurrentValue["FontCapHeight"])/
                  AbsoluteCurrentValue[Magnification]}], 
               PlotRange -> {{-1.1, 2.4}, {-4.4, -0.7}}], 
              GridBox[{{
                 RowBox[{
                   TagBox["\"Vertex count: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["6", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Edge count: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["7", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Type: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["\"directed graph\"", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Connected graph: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    DynamicBox[
                    ToBoxes[
                    ConnectedGraphQ[Typeset`sgraph$$], StandardForm], 
                    SynchronousUpdating -> False, TrackedSymbols :> {}, 
                    CachedValue :> 
                    AnimatorBox[
                    0, {0, Infinity}, AppearanceElements -> "ProgressSlider", 
                    ImageSize -> 20]], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Acyclic graph: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    DynamicBox[
                    ToBoxes[
                    AcyclicGraphQ[Typeset`sgraph$$], StandardForm], 
                    SynchronousUpdating -> False, TrackedSymbols :> {}, 
                    CachedValue :> 
                    AnimatorBox[
                    0, {0, Infinity}, AppearanceElements -> "ProgressSlider", 
                    ImageSize -> 20]], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic]},
       "SummaryPanel"],
      DynamicModuleValues:>{}], "]"}],
    Typeset`sgraph$$,
    Editable->False,
    SelectWithContents->True,
    Selectable->False],
   DynamicModuleValues:>{}],
  Setting[#, {0}]& ]], "Output",
 CellChangeTimes->{{3.9696191119132414`*^9, 3.9696191346883717`*^9}, 
   3.9696193605347385`*^9, 3.9696730668193893`*^9, 3.9696738031602793`*^9, 
   3.9696742005742464`*^9, 3.9696743328508067`*^9},
 CellLabel->
  "Out[1053]=",ExpressionUUID->"01a6f563-4116-451b-bfba-f36aab9cb606"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RN2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\"\<A\>\"", "+", "\"\<B\>\""}], "->", 
      RowBox[{"2", "*", "\"\<A\>\""}]}], ",", 
     RowBox[{"\"\<A\>\"", "->", "\"\<B\>\""}], ",", 
     RowBox[{"\"\<B\>\"", "->", "0"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"res2", "=", 
   RowBox[{"testMAS", "[", "RN2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RN3", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\"\<I1\>\"", "+", "\"\<S\>\""}], "->", 
      RowBox[{"2", "*", "\"\<I1\>\""}]}], ",", 
     RowBox[{
      RowBox[{"\"\<I2\>\"", "+", "\"\<S\>\""}], "->", 
      RowBox[{"2", "*", "\"\<I2\>\""}]}], ",", 
     RowBox[{
      RowBox[{"\"\<I12\>\"", "+", "\"\<S\>\""}], "->", 
      RowBox[{"2", "*", "\"\<I12\>\""}]}], ",", 
     RowBox[{
      RowBox[{"\"\<I1\>\"", "+", "\"\<I2\>\""}], "->", 
      RowBox[{"2", "*", "\"\<I12\>\""}]}], ",", 
     RowBox[{"(*", "recombination", "*)"}], 
     RowBox[{"0", "->", "\"\<S\>\""}], ",", 
     RowBox[{"\"\<S\>\"", "->", "0"}], ",", 
     RowBox[{"\"\<I1\>\"", "->", "0"}], ",", 
     RowBox[{"\"\<I2\>\"", "->", "0"}], ",", 
     RowBox[{"\"\<I12\>\"", "->", "0"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"res3", "=", 
   RowBox[{"testMAS", "[", "RN3", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9698564627011538`*^9, 
  3.969856463987957*^9}},ExpressionUUID->"a2019d27-b9d1-492f-8d23-\
f0558af43a65"]
},
WindowSize->{791.1428571428571, 371.57142857142856`},
WindowMargins->{{Automatic, 3.428571428571445}, {-9, Automatic}},
FrontEndVersion->"13.3 for Microsoft Windows (64-bit) (June 3, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"41ddad75-85fa-4d68-8bf2-9a16b2dcc89d"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 18293, 454, 1741, "Input",ExpressionUUID->"738c8143-b87b-45aa-b8a5-0ce1ff986b15"],
Cell[CellGroupData[{
Cell[18898, 480, 288, 5, 22, "Print",ExpressionUUID->"e6e2e171-d7fa-4363-8d30-24fc67e70143"],
Cell[19189, 487, 453, 10, 22, "Print",ExpressionUUID->"6b9e946e-d6cd-4fcb-85ac-5432b0bf45f2"],
Cell[19645, 499, 519, 11, 22, "Print",ExpressionUUID->"734ae270-a9b4-41aa-a5c9-8b7b4409cdcb"],
Cell[20167, 512, 619, 14, 22, "Print",ExpressionUUID->"780b7ddf-afbe-4866-98f5-c49e98563ace"],
Cell[20789, 528, 521, 11, 22, "Print",ExpressionUUID->"1dcb0724-2319-4abd-bb2e-b743258e8766"],
Cell[21313, 541, 712, 17, 22, "Print",ExpressionUUID->"ffa2dbe5-18a0-4ff8-a743-12a6a0ef5a7b"],
Cell[22028, 560, 260, 5, 22, "Print",ExpressionUUID->"3fd76ca4-efe2-4464-b766-174af661d175"],
Cell[22291, 567, 279, 5, 22, "Print",ExpressionUUID->"c42d29ad-4631-4b2d-8a8a-566a354f988b"],
Cell[22573, 574, 487, 11, 22, "Print",ExpressionUUID->"6eae3a72-001f-4762-a2a0-530855e9d002"],
Cell[23063, 587, 495, 11, 22, "Print",ExpressionUUID->"b4b78f3d-5976-4d81-95d8-d610e6ffa0d5"],
Cell[23561, 600, 269, 5, 22, "Print",ExpressionUUID->"6fd9fd06-5467-4306-b1b7-24a9be04be38"],
Cell[23833, 607, 2364, 59, 75, "Print",ExpressionUUID->"f7d2266a-74cf-49f0-8ee0-db8d2ab19b41"],
Cell[26200, 668, 292, 5, 40, "Print",ExpressionUUID->"dca5a280-fb5b-4494-aee7-2025cd06c4b8"],
Cell[26495, 675, 269, 5, 22, "Print",ExpressionUUID->"dc7dcae9-b6e0-4b2a-914c-6df972dc4fe3"],
Cell[26767, 682, 285, 5, 40, "Print",ExpressionUUID->"24480743-c90c-4222-8efd-351ae201936d"]
}, Open  ]],
Cell[27067, 690, 11077, 234, 62, "Output",ExpressionUUID->"01a6f563-4116-451b-bfba-f36aab9cb606"]
}, Open  ]],
Cell[38159, 927, 1468, 40, 105, "Input",ExpressionUUID->"a2019d27-b9d1-492f-8d23-f0558af43a65"]
}
]
*)

