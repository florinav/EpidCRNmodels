(* Recker Antigenic Variation Model *)
(* Multi-strain pathogen model with antigenic variation *)

<<EpidCRN`

(* Model Definition: 3-strain Recker Model *)
RN = {
  0 -> "s",
  "s" + "i1" -> 2*"i1",
  "s" + "i2" -> 2*"i2",
  "s" + "i3" -> 2*"i3",
  "i1" -> "r1",
  "i2" -> "r2",
  "i3" -> "r3",
  "s" -> 0,
  "i1" -> 0,
  "i2" -> 0,
  "i3" -> 0,
  "r1" -> 0,
  "r2" -> 0,
  "r3" -> 0,
  "r1" -> "s",
  "r2" -> "s",
  "r3" -> "s"
}

rts = {
  \[CapitalLambda],
  \[Beta]1*s*i1,
  \[Beta]2*s*i2,
  \[Beta]3*s*i3,
  \[Gamma]1*i1,
  \[Gamma]2*i2,
  \[Gamma]3*i3,
  \[Mu]*s,
  \[Mu]*i1,
  \[Mu]*i2,
  \[Mu]*i3,
  \[Mu]*r1,
  \[Mu]*r2,
  \[Mu]*r3,
  \[Rho]1*r1,
  \[Rho]2*r2,
  \[Rho]3*r3
}

(* Analysis *)
recAnt[RN_, rts_] := bd2[RN, rts]

results = recAnt[RN, rts]
{RHS, var, par, cp, mSi, Jx, Jy, E0, ngm, R0A, EA, bdfpT} = results
Print["Minimal Siphons: ", mSi]
Print["R0 values: ", R0A]
Print["Boundary fixed points: ", bdfpT]
