(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     15724,        354]
NotebookOptionsPosition[     14847,        333]
NotebookOutlinePosition[     15256,        349]
CellTagsIndexPosition[     15213,        346]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Latex", " ", "dict"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Format", "[", "ga1", "]"}], ":=", 
     RowBox[{"Subscript", "[", 
      RowBox[{"\[Gamma]", ",", "1"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Format", "[", "ga2", "]"}], ":=", 
     RowBox[{"Subscript", "[", 
      RowBox[{"\[Gamma]", ",", "2"}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"Format", "[", "be11", "]"}], ":=", 
     RowBox[{"Subscript", "[", 
      RowBox[{"\[Beta]", ",", "11"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Format", "[", "mu", "]"}], ":=", "\[Mu]"}], ";", 
    RowBox[{
     RowBox[{"Format", "[", "La1", "]"}], ":=", 
     RowBox[{"Subscript", "[", 
      RowBox[{"\[CapitalLambda]", ",", "1"}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"Format", "[", "La2", "]"}], ":=", 
     RowBox[{"Subscript", "[", 
      RowBox[{"\[CapitalLambda]", ",", "2"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Format", "[", "de1", "]"}], ":=", 
     RowBox[{"Subscript", "[", 
      RowBox[{"\[Delta]", ",", "1"}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"Format", "[", "de2", "]"}], ":=", 
     RowBox[{"Subscript", "[", 
      RowBox[{"\[Delta]", ",", "2"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Format", "[", "be12", "]"}], ":=", 
     RowBox[{"Subscript", "[", 
      RowBox[{"\[Beta]", ",", "12"}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"Format", "[", "be21", "]"}], ":=", 
     RowBox[{"Subscript", "[", 
      RowBox[{"\[Beta]", ",", "21"}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"Format", "[", "be22", "]"}], ":=", 
     RowBox[{"Subscript", "[", 
      RowBox[{"\[Beta]", ",", "22"}], "]"}]}], ";"}], 
   StyleBox["\n",
    FontWeight->"Plain"], 
   RowBox[{
    RowBox[{
     RowBox[{"Format", "[", "S1", "]"}], ":=", 
     RowBox[{"Subscript", "[", 
      RowBox[{"S", ",", "1"}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"Format", "[", "S2", "]"}], ":=", 
     RowBox[{"Subscript", "[", 
      RowBox[{"S", ",", "2"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.9653498815644903`*^9, 3.9653498815644903`*^9}, {
   3.9653499162494802`*^9, 3.965349933966921*^9}, {3.965349998071741*^9, 
   3.9653500058841724`*^9}, {3.9653500509581738`*^9, 3.9653500713093076`*^9}, 
   3.965350105727036*^9, {3.965350160614517*^9, 3.965350166747674*^9}, 
   3.9653509328187532`*^9, {3.9653509774194536`*^9, 3.965350980259142*^9}, {
   3.9653510114431686`*^9, 3.965351028447853*^9}, {3.965351903430425*^9, 
   3.9653519069298067`*^9}, {3.965351997294992*^9, 3.9653520277358994`*^9}, {
   3.9653521144803348`*^9, 3.965352121194975*^9}, {3.965352370547117*^9, 
   3.965352403775177*^9}, {3.9653525456621823`*^9, 3.96535255404986*^9}, {
   3.9653525847624516`*^9, 3.965352592063557*^9}, {3.9653526930364504`*^9, 
   3.965352746984132*^9}, {3.9653529423879004`*^9, 3.965352960033264*^9}, {
   3.965353182483048*^9, 3.965353197521265*^9}, {3.9653553765721025`*^9, 
   3.965355377355079*^9}, {3.965355494153541*^9, 3.9653555292804785`*^9}, 
   3.96535683332181*^9},ExpressionUUID->"d80672b4-2009-4bdb-8b05-\
2a3fc31d87d7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global\[OpenCurlyQuote]*\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";", 
  RowBox[{"SetOptions", "[", 
   RowBox[{"$FrontEndSession", ",", " ", 
    RowBox[{"NotebookAutoSave", " ", "->", " ", "True"}]}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"NotebookSave", "[", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"$Path", ",", " ", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
      "$HomeDirectory", ",", " ", "\"\<Dropbox\>\"", ",", " ", 
       "\"\<EpidCRNmodels\>\""}], "}"}], "]"}]}], "]"}], ";", 
  RowBox[{"<<", "EpidCRN`"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RN", " ", "=", " ", 
   RowBox[{"{", "\n", "  ", 
    RowBox[{
     RowBox[{"0", " ", "->", " ", "\"\<S1\>\""}], ",", 
     RowBox[{"0", " ", "->", " ", "\"\<S2\>\""}], ",", "\n", "  ", 
     RowBox[{
      RowBox[{"\"\<S1\>\"", " ", "+", " ", "\"\<I1\>\""}], " ", "->", " ", 
      RowBox[{"2", "*", "\"\<I1\>\""}]}], ",", "\n", "  ", 
     RowBox[{
      RowBox[{"\"\<S1\>\"", " ", "+", " ", "\"\<I2\>\""}], " ", "->", " ", 
      RowBox[{"\"\<I1\>\"", " ", "+", "\"\<I2\>\""}]}], ",", "\n", "  ", 
     RowBox[{
      RowBox[{"\"\<S2\>\"", " ", "+", " ", "\"\<I1\>\""}], " ", "->", " ", 
      RowBox[{"2", "*", "\"\<I1\>\""}]}], ",", "\n", "  ", 
     RowBox[{
      RowBox[{"\"\<S2\>\"", " ", "+", " ", "\"\<I2\>\""}], " ", "->", " ", 
      RowBox[{"\"\<I1\>\"", " ", "+", "\"\<I2\>\""}]}], ",", "\n", "  ", 
     RowBox[{"\"\<I1\>\"", " ", "->", " ", "\"\<I2\>\""}], ",", "\n", "  ", 
     RowBox[{"\"\<S1\>\"", " ", "->", " ", "0"}], ",", "\n", "  ", 
     RowBox[{"\"\<S2\>\"", " ", "->", " ", "0"}], ",", "\n", "  ", 
     RowBox[{"\"\<I1\>\"", " ", "->", " ", "0"}], ",", "\n", "  ", 
     RowBox[{"\"\<I2\>\"", " ", "->", " ", "0"}]}], "\n", "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"rts", "=", 
    RowBox[{"{", 
     RowBox[{"La1", ",", " ", "La2", ",", 
      RowBox[{"be11", " ", "I1", " ", "S1"}], ",", 
      RowBox[{"be12", " ", "I2", " ", "S1"}], ",", " ", 
      RowBox[{"be21", " ", "I1", " ", "S2"}], ",", 
      RowBox[{"be22", " ", "I2", " ", "S2"}], ",", 
      RowBox[{"ga1", " ", "I1"}], ",", 
      RowBox[{"mu", " ", "S1"}], ",", 
      RowBox[{"mu", " ", "S2"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"mu", "+", "de1"}], ")"}], "I1"}], ",", "\n", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"mu", "+", "ga2", "+", " ", "de2"}], ")"}], "I2"}]}], "}"}]}],
    ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tk", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Symbol", "[", 
       RowBox[{"\"\<k\>\"", " ", "<>", " ", 
        RowBox[{"ToString", "[", "#", "]"}]}], "]"}], " ", "&"}], ",", " ", 
     RowBox[{"RN", "//", "Length"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"com", ",", "edg"}], "}"}], "=", 
   RowBox[{"getComE", "[", "RN", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gg", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
   RowBox[{"Which", "[", 
    RowBox[{
     RowBox[{"a", "===", 
      RowBox[{"b", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"a", "===", 
      RowBox[{"b", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ",", "1", ",", "True", ",", "0"}], 
    "]"}]}], ";", 
  RowBox[{"oU", "=", 
   RowBox[{"Outer", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"gg", "[", 
       RowBox[{"#1", ",", " ", "#2"}], "]"}], " ", "&"}], ",", " ", "com", 
     ",", " ", "edg", ",", " ", "1"}], "]"}]}], ";", 
  RowBox[{
   RowBox[{"lapK", "[", 
    RowBox[{"RN", ",", "tk"}], "]"}], "//", "MatrixForm"}]}]}], "Input",
 CellChangeTimes->{{3.9653498815644903`*^9, 3.9653498815644903`*^9}, {
   3.9653499162494802`*^9, 3.965349933966921*^9}, {3.965349998071741*^9, 
   3.9653500058841724`*^9}, {3.9653500509581738`*^9, 3.9653500713093076`*^9}, 
   3.965350105727036*^9, {3.965350160614517*^9, 3.965350166747674*^9}, 
   3.9653509328187532`*^9, {3.9653509774194536`*^9, 3.965350980259142*^9}, {
   3.9653510114431686`*^9, 3.965351028447853*^9}, {3.965351903430425*^9, 
   3.9653519069298067`*^9}, {3.965351997294992*^9, 3.9653520277358994`*^9}, {
   3.9653521144803348`*^9, 3.965352121194975*^9}, {3.965352370547117*^9, 
   3.965352403775177*^9}, {3.9653525456621823`*^9, 3.96535255404986*^9}, {
   3.9653525847624516`*^9, 3.965352592063557*^9}, {3.9653526930364504`*^9, 
   3.965352746984132*^9}, {3.9653529423879004`*^9, 3.965352960033264*^9}, {
   3.965353182483048*^9, 3.965353197521265*^9}, {3.9653553765721025`*^9, 
   3.965355377355079*^9}, {3.965355494153541*^9, 3.9653555292804785`*^9}, 
   3.96535683332181*^9, {3.965357933348217*^9, 3.965357950926074*^9}, 
   3.96535856052227*^9, 3.96536166359286*^9, {3.9653617288483024`*^9, 
   3.965361751914818*^9}, 3.965361927372895*^9, {3.965362005381319*^9, 
   3.9653620081098566`*^9}, {3.9653620401943674`*^9, 3.965362044267659*^9}, {
   3.9653621203808126`*^9, 3.965362129556569*^9}},
 CellLabel->
  "In[2456]:=",ExpressionUUID->"1418f090-79bb-4e1a-8f27-0105672fce9e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "k1"}], "-", "k2"}], "k8", "k9", "0", "0", "0", "0", "0", 
      "0", "k10", "k11"},
     {"k1", 
      RowBox[{"-", "k8"}], "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"k2", "0", 
      RowBox[{"-", "k9"}], "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      RowBox[{"-", "k3"}], "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "k3", "0", "0", "0", "k5", "0", "0", "0"},
     {"0", "0", "0", "0", "0", 
      RowBox[{"-", "k4"}], "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "k4", "0", "0", "k6", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "k5"}], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "k6"}], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{
       RowBox[{"-", "k10"}], "-", "k7"}], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "k7", 
      RowBox[{"-", "k11"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.9653616698455544`*^9, {3.9653617365367107`*^9, 3.9653617564075565`*^9}, 
   3.9653619349898453`*^9, 3.965362009307784*^9, 3.965362046465086*^9, {
   3.9653621066674337`*^9, 3.9653621306547284`*^9}},
 CellLabel->
  "Out[2464]//MatrixForm=",ExpressionUUID->"b23b2c50-1a2f-4503-ab77-\
04f5803d66d2"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9653498815644903`*^9, 3.9653498815644903`*^9}, {
   3.9653499162494802`*^9, 3.965349933966921*^9}, {3.965349998071741*^9, 
   3.9653500058841724`*^9}, {3.9653500509581738`*^9, 3.9653500713093076`*^9}, 
   3.965350105727036*^9, {3.965350160614517*^9, 3.965350166747674*^9}, 
   3.9653509328187532`*^9, {3.9653509774194536`*^9, 3.965350980259142*^9}, {
   3.9653510114431686`*^9, 3.965351028447853*^9}, {3.965351903430425*^9, 
   3.9653519069298067`*^9}, {3.965351997294992*^9, 3.9653520277358994`*^9}, {
   3.9653521144803348`*^9, 3.965352121194975*^9}, {3.965352370547117*^9, 
   3.965352403775177*^9}, {3.9653525456621823`*^9, 3.96535255404986*^9}, {
   3.9653525847624516`*^9, 3.965352592063557*^9}, {3.9653526930364504`*^9, 
   3.965352746984132*^9}, {3.9653529423879004`*^9, 3.965352960033264*^9}, {
   3.965353182483048*^9, 3.965353197521265*^9}, {3.9653553765721025`*^9, 
   3.965355377355079*^9}, {3.965355494153541*^9, 3.9653555292804785`*^9}, 
   3.96535683332181*^9, {3.965357933348217*^9, 3.965357950926074*^9}, 
   3.96535856052227*^9, {3.965358741112645*^9, 3.965358857509862*^9}, {
   3.9653589227405853`*^9, 3.9653589389679594`*^9}, {3.9653591424555035`*^9, 
   3.965359145906666*^9}, {3.965361042022812*^9, 3.9653610499389315`*^9}, {
   3.9653612482519703`*^9, 3.9653612895398235`*^9}, 3.9653617163315735`*^9},
 CellLabel->
  "In[1876]:=",ExpressionUUID->"65550dfe-3ceb-416d-8bc2-c48afcec828e"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9653498815644903`*^9, 3.9653498815644903`*^9}, {
   3.9653499162494802`*^9, 3.965349933966921*^9}, {3.965349998071741*^9, 
   3.9653500058841724`*^9}, {3.9653500509581738`*^9, 3.9653500713093076`*^9}, 
   3.965350105727036*^9, {3.965350160614517*^9, 3.965350166747674*^9}, 
   3.9653509328187532`*^9, {3.9653509774194536`*^9, 3.965350980259142*^9}, {
   3.9653510114431686`*^9, 3.965351028447853*^9}, {3.965351903430425*^9, 
   3.9653519069298067`*^9}, {3.965351997294992*^9, 3.9653520277358994`*^9}, {
   3.9653521144803348`*^9, 3.965352121194975*^9}, {3.965352370547117*^9, 
   3.965352403775177*^9}, {3.9653525456621823`*^9, 3.96535255404986*^9}, {
   3.9653525847624516`*^9, 3.965352592063557*^9}, {3.9653526930364504`*^9, 
   3.965352746984132*^9}, {3.9653529423879004`*^9, 3.965352960033264*^9}, {
   3.965353182483048*^9, 3.965353197521265*^9}, {3.9653553765721025`*^9, 
   3.965355377355079*^9}, {3.965355494153541*^9, 3.9653555292804785`*^9}, 
   3.96535683332181*^9, {3.965357933348217*^9, 3.965357950926074*^9}, 
   3.96535856052227*^9, {3.965358741112645*^9, 3.965358857509862*^9}, {
   3.9653589227405853`*^9, 3.965358928674887*^9}, {3.9653613173865657`*^9, 
   3.965361361403254*^9}, 3.9653616530454965`*^9},
 CellLabel->
  "In[1867]:=",ExpressionUUID->"206492a7-be18-4dd6-8a9d-270c0a86aa13"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9653498815644903`*^9, 3.9653498815644903`*^9}, {
   3.9653499162494802`*^9, 3.965349933966921*^9}, {3.965349998071741*^9, 
   3.9653500058841724`*^9}, {3.9653500509581738`*^9, 3.9653500713093076`*^9}, 
   3.965350105727036*^9, {3.965350160614517*^9, 3.965350166747674*^9}, 
   3.9653509328187532`*^9, {3.9653509774194536`*^9, 3.965350980259142*^9}, {
   3.9653510114431686`*^9, 3.965351028447853*^9}, {3.965351903430425*^9, 
   3.9653519069298067`*^9}, {3.965351997294992*^9, 3.9653520277358994`*^9}, {
   3.9653521144803348`*^9, 3.965352121194975*^9}, {3.965352370547117*^9, 
   3.965352403775177*^9}, {3.9653525456621823`*^9, 3.96535255404986*^9}, {
   3.9653525847624516`*^9, 3.965352592063557*^9}, {3.9653526930364504`*^9, 
   3.965352746984132*^9}, {3.9653529423879004`*^9, 3.965352960033264*^9}, {
   3.965353182483048*^9, 3.965353197521265*^9}, {3.9653553765721025`*^9, 
   3.965355377355079*^9}, {3.965355494153541*^9, 3.9653555292804785`*^9}, 
   3.96535683332181*^9, {3.965357933348217*^9, 3.965357950926074*^9}, 
   3.96535856052227*^9, {3.965358741112645*^9, 3.965358841678688*^9}, 
   3.9653620230854473`*^9},
 CellLabel->
  "In[2182]:=",ExpressionUUID->"413ea796-b1bb-4975-ab7e-8dd688dd99c1"]
},
WindowSize->{812.5714285714286, 384},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"13.3 for Microsoft Windows (64-bit) (June 3, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"855ad77f-eb9d-4443-bf63-3db35f27ced6"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 3163, 77, 181, "Input",ExpressionUUID->"d80672b4-2009-4bdb-8b05-2a3fc31d87d7"],
Cell[CellGroupData[{
Cell[3746, 101, 5266, 121, 504, "Input",ExpressionUUID->"1418f090-79bb-4e1a-8f27-0105672fce9e"],
Cell[9015, 224, 1738, 43, 198, "Output",ExpressionUUID->"b23b2c50-1a2f-4503-ab77-04f5803d66d2"]
}, Open  ]],
Cell[10768, 270, 1459, 20, 28, "Input",ExpressionUUID->"65550dfe-3ceb-416d-8bc2-c48afcec828e"],
Cell[12230, 292, 1355, 19, 28, "Input",ExpressionUUID->"206492a7-be18-4dd6-8a9d-270c0a86aa13"],
Cell[13588, 313, 1255, 18, 28, "Input",ExpressionUUID->"413ea796-b1bb-4975-ab7e-8dd688dd99c1"]
}
]
*)

