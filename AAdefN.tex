%% ========================================
%% PACKAGES
%% ========================================
\usepackage{makecell}
\usepackage[novbox]{pdfsync}
\usepackage{amssymb, amsfonts,mathtools}
\usepackage{eurosym,graphicx,latexsym, amsmath,amsthm,times,nccmath,url}
\usepackage{listings,verbatim,cases,hyperref,tabularx}
\usepackage{graphicx,float,fancybox}
\usepackage{epsfig,epstopdf,tikz}
\usepackage[sans]{dsfont}
\usetikzlibrary{positioning,arrows,arrows.meta,calc}


\newtheorem{theorem}{Theorem}
\newtheorem{definition}{Definition}
\newtheorem{open}{Open Problem}
\newtheorem{example}{Example}

% COUNTER DEFINITIONS
\newcounter{tabcounter}
\newcounter{defcounter}
\newcounter{opcounter}
\newcounter{thmcounter}
\newcounter{excounter}

% UNIFIED GLOSSARY STYLE
\newglossarystyle{unifiedstyle}{
  \setglossarystyle{list}
  \renewcommand{\glossentry}[2]{
    \item[\glsentryuserii{##1} \glsentryuseri{##1}:] ``\glossentryname{##1}'' \glsentrydesc{##1}
  }
}

\makeatletter
\newcommand{\beXa}[1][]{%
  \def\@temparg{#1}%
  \ifx\@temparg\@empty
    \begin{example}%
  \else
    \refstepcounter{excounter}%  % Step the counter
    \begin{example}[#1]%
    \label{e:#1}%                 % Create a label (using 'e' for example)
    \newglossaryentry{e\theexcounter}{%
      name={#1},%
      description={p.~\pageref{e:#1}},%  % Use pageref of the label
      user1={\theexcounter},%
      user2={Example}%              % Use 'Example' as the category
    }%
  \fi
}
\newcommand{\eeXa}{\end{example}}

\newcommand{\beD}[1][]{%
  \def\@temparg{#1}%
  \ifx\@temparg\@empty
    \begin{definition}%
  \else
    \refstepcounter{defcounter}%
    \begin{definition}[#1]%
    \label{d:#1}%
    \newglossaryentry{d\thedefcounter}{%
      name={#1},%
      description={p.~\pageref{d:#1}},%  % Use pageref of the label
      user1={\thedefcounter},%
      user2={Definition}%
    }%
  \fi
}
\newcommand{\eeD}{\end{definition}}

% TheorEM COMMAND
\newcommand{\beT}[1][]{%
  \def\@temparg{#1}%
  \ifx\@temparg\@empty
    \begin{theorem}%
  \else
    \refstepcounter{thmcounter}%
    \begin{theorem}[#1]%
    \label{t:#1}%
    \newglossaryentry{t\thethmcounter}{%
      name={#1},%
      description={p.~\pageref{t:#1}},%
      user1={\thethmcounter},%
      user2={Theorem}%
    }%
  \fi
}
\newcommand{\eeT}{\end{theorem}}
% OPEN PROBLEM COMMANDS
\newcommand{\beO}[1][]{%
  \def\@temparg{#1}%
  \ifx\@temparg\@empty
    \begin{open}%
  \else
    \refstepcounter{opcounter}%
    \begin{open}[#1]%
    \label{op:#1}%
    \newglossaryentry{o\theopcounter}{%
      name={#1},%
      description={p.~\pageref{op:#1}},%  % Use pageref of the label
      user1={\theopcounter},%
      user2={Open Problem}%
    }%
  \fi
}
\newcommand{\eeO}{\end{open}}

% The macro now accepts only the Name as an optional argument.
\newcommand{\betA}[1][]{%
  \def\@temparg{#1}%
  \ifx\@temparg\@empty
    % Case 1: No Name. Use standard table with common float placement options.
    \begin{table}[htbp]%
  \else
    % Case 2: Name is present.
    \refstepcounter{tabcounter}%
    \begin{table}[htbp]%

    % The stable, numeric label key fixes the "p. ??" glossary error.
    \label{A:\thetabcounter}%

    \newglossaryentry{A\thetabcounter}{%
      name={#1},% % Uses the Name for the glossary title
      description={p.~\pageref{A:\thetabcounter}},%
      user1={\thetabcounter},%
      user2={Table}%
    }%
  \fi
}

\newcommand{\eetA}{\end{table}}
\makeatother
% PRINT COMMAND
\newcommand{\printboth}{%
  \glsaddall  % Add all entries to glossary
  \printglossary[style=unifiedstyle, title={Definitions, Theorems, Examples and Open Problems}]%
}

%% ========================================
%% Other THEOREM ENVIRONMENTS
%% ========================================
\newtheorem{lemma}{Lemma}
\newtheorem{proposition}{Proposition}
\newtheorem{corollary}{Corollary}
\newtheorem{conjecture}{Conjecture}
\newtheorem{remark}{Remark}
\newtheorem{question}{Question}
\newtheorem{assumption}{Assumption}
\newtheorem{hypothesis}{Hypothesis}
\newtheorem{fact}{Fact}


% Abbreviations
\def\beL{\begin{lemma}}\def\eeL{\end{lemma}}
\def\beP{\begin{proposition}}\def\eeP{\end{proposition}}
\def\beC{\begin{corollary}}\def\eeC{\end{corollary}}
\def\beR{\begin{remark}}\def\eeR{\end{remark}}
\def\beQ{\begin{question}}\def\eeQ{\end{question}}
\def\beA{\begin{assumption}}\def\eeA{\end{assumption}}


%% ========================================

%% ========================================
%% COLORS & CUSTOM COMMANDS
%% ========================================
\definecolor{funccolor}{RGB}{25,25,112}
\definecolor{desccolor}{RGB}{64,64,64}
\newcommand{\func}[1]{\texttt{\textcolor{funccolor}{#1}}}


%% ========================================
%% BASIC MATH ENVIRONMENTS
%% ========================================
\def\bep{\begin{pmatrix}}\def\eep{\end{pmatrix}}
\def\bev{\begin{vmatrix}}\def\eev{\end{vmatrix}}
\def\bea{\begin{eqnarray*}}\def\eea{\end{eqnarray*}}
\def\bc{\begin{cases}}\def\ec{\end{cases}}
\def\BEN{\begin{enumerate}}\def\EEN{\end{enumerate}}
\def\BI{\begin{itemize}}\def\EI{\end{itemize}}

\newcommand{\be}[1]{\begin{equation}\label{#1}}
\newcommand{\ee}{\end{equation}}
\newcommand{\beq}{\begin{eqnarray}}
\def\eeq{\end{eqnarray}}
\def\eqr{\eqref}\def\fr{\frac}\def\lbl{\label}
\def\Lra{\Longrightarrow}\def\non{\nonumber}\def\cNGM{\cite{Diek,Van,Van08}}
\def\Eq{\Leftrightarrow}\def\b{\beta}\def\uph{\red{UP TO HERE}}
%% ========================================
%% PROBABILITY & STATISTICS
%% ========================================
\newcommand{\E}{\ensuremath{\mathbb{E}}}
\renewcommand{\P}{\ensuremath{\mathbb{P}}}  % Note: overrides paragraph symbol
\newcommand{\ind}[1]{\ensuremath{\mathbbm{1}_{\left\{#1\right\}}}}
\DeclareMathOperator{\Cov}{Cov}
\DeclareMathOperator{\TV}{TV}


%% ========================================
%% NUMBER SETS
%% ========================================
\newcommand{\R}{\mathbb{R}}  % Real numbers
\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\MN}{\mathbb{N}}
\newcommand{\MZ}{\mathbb{Z}}
\newcommand{\realpos}{\mathbb{R}_{> 0}}
\newcommand{\realnneg}{\mathbb{R}_{\geq 0}}
\newcommand{\naturalpos}{\mathbb{N}_{>0}}
\newcommand{\Rplus}{\mathbb{R}_+}


%% ========================================
%% GREEK LETTERS (2+ character abbreviations)
%% ========================================
\def\al{\alpha}\def\ba{\bff \alpha}
\def\bbe{B}
\def\de{\delta}\def\De{\Delta}\def\bde{\bff \delta}
\def\ep{\epsilon}\def\eps{\varepsilon}
\def\f{\varphi}  % Kept as requested
\def\ga{\gamma}\def\Ga{\Gamma}\def\G{\Gamma}\def\bg{\bff \gamma}
\def\la{\lambda}\def\La{\Lambda}
\def\si{\sigma}
\def\th{\theta}\def\vt{\vartheta}
\def\ze{\zeta}


%% ========================================
%% SPECIAL SHORT COMMANDS (kept as requested)
%% ========================================
\def\I{\infty}
\def\T{\widetilde}
\def\H{\hat}


%% ========================================
%% BOLD/VECTOR NOTATION
%% ========================================
\newcommand{\bff}[1]{{\mbox{\boldmath$#1$}}}
\newcommand\X{\boldsymbol{X}}
\def\x{\boldsymbol{x}}\def\bx{\bff x}\def\xe{\bar{\x}}
\newcommand\y{\boldsymbol{y}}\def\by{\boldsymbol{y}}\def\ye{\bar{\y}}
\def\yb{\y}\def\xb{\x}
\def\xy{\x-\y}
\newcommand\br{\boldsymbol{r}}\def\re{\bar{\r}}
\newcommand\bd{\boldsymbol{d}}
\newcommand\bQ{\boldsymbol{Q}}
\newcommand{\Yb}{{\mathbf{Y}}}
\newcommand{\Ab}{\mathbf{A}}
\newcommand{\zb}{\mathbf{z}}\def\bz{\bff 0}
\newcommand{\Zb}{\mathbf{Z}}
\newcommand{\bb}{\mathbf{b}}
\def\vbe{\vec {\bff \beta}}
\def\vb{\vec {\bff b}}
\def\v1{\vec {\bff 1}}
\def\vn{\vec \de}
\def\vz{\vec 0}
\def\vi{\overset{\rightarrow}{\mathsf \i}}
\def\vv{\overset{\rightarrow}{v}}
\def\vr{\; \vec {\mathsf r}}
\newcommand{\va}{\bff a}


%% ========================================
%% MATHCAL & MATHSCR
%% ========================================
% Mathcal
\def\mC{{\mathcal C}}\def\mD{\mathcal D}\def\mE{\mathcal{E}}
\def\mF{\mathcal F}\def\mG{{\mathcal G}}\def\mH{{\mathcal H}}
\def\mI{\mathcal I}\def\mL{\mathcal{L}}\def\mM{{\mathcal M}}
\def\mN{{\mathcal N}}\def\mP{\mathcal{P}}\def\mR{{\mathcal R}}
\def\mS{{\mathcal S}}\def\mT{\mathcal{T}}\def\mV{{\mathcal V}}
\newcommand{\cH}{{\mathcal H}}\newcommand{\cT}{\mathcal T}
\newcommand{\cK}{\mathcal K}

% Mathscr
\newcommand{\Rs}{{\mathscr R}}
\newcommand{\Ss}{{\mathscr S}}
\newcommand{\Ns}{{\mathscr N}}
\newcommand{\Cs}{\mathscr C}


%% ========================================
%% OPERATORS & FUNCTIONS
%% ========================================
\DeclareMathOperator{\tr}{tr}
\DeclareMathOperator{\diag}{Diag}
\DeclareMathOperator{\intr}{\mathrm{Int}}
\newcommand\op{\operatorname}
\newcommand{\supp}{\op{supp}}
\newcommand{\diff}{\mathop{}\mathopen{}\mathrm{d}}
\newcommand{\pdd}[1]{\frac{\partial}{\partial{#1}}}


%% ========================================
%% BRACKETS & NORMS
%% ========================================
\providecommand{\pr}[1]{\left(#1\right)}
\providecommand{\pp}[1]{\left[#1\right]}
\newcommand\croc[1]{\left\langle #1\right\rangle}
\newcommand{\norm}[1]{\|#1\|}
\newcommand{\inner}[2]{\langle #1, #2 \rangle}


%% ========================================
%% FORMATTING & UTILITIES
%% ========================================
\newcommand*{\Scale}[2][4]{\scalebox{#1}{$#2$}}
\newcommand{\te}[1]{\text{#1}}
\newcommand\steq[1]{\stackrel{\text{\rm #1.}}{=}}
\newcommand\blue[1]{\textcolor{blue}{#1}}
\newcommand{\red}{\textcolor[rgb]{1.00,0.00,0.00}}
\newcommand{\green}{\textcolor[rgb]{0.00,1.00,0.00}}

% Figure command
\newcommand{\figu}[3]{%
\begin{figure}[H]
\centering
\includegraphics[scale=#3]{#1}
\caption{#2\label{f:#1}}
\end{figure}
}

% Footnote
\long\def\symbolfootnote[#1]#2{%
\begingroup
\def\thefootnote{\fnsymbol{footnote}}\footnote[#1]{#2}%
\endgroup}
\def\fn{\symbolfootnote}


%% ========================================
%% CRN & EPIDEMIOLOGY SPECIFIC
%% ========================================
% CRN notation
\def\SS{\mathcal S}
\def\CC{\mathcal C}
\def\RR{\mathcal R}

% Reproduction numbers
\def\Rot{R_{{1}}^{\tilde{2}}}
\def\Rto{R_{{2}}^{\tilde{1}}}
\def\Roc{R_{1,c}}
\def\Rtc{R_{2,c}}
\def\rd{r_{0}}
\def\sd{s_{0}}
\def\dd{D_{0}}
\def\vd{v_{0}}
\def\zd{z_{0}}
\def\se{\sE}

%% ========================================
%% SPECIAL VALUES & EQUILIBRIA
%% ========================================
\def\eE{\bar{e}}
\def\wE{\bar{w}}
\def\sE{s_{ee}}
\def\Me{M_{ee}}



%% ========================================
%% ABBREVIATIONS (alphabetical by category)
%% ========================================

% -- General mathematical terms --
\def\adm{admissible}\def\admy{admissibility}
\def\and{antisymmetric}
\def\ass{assumption}
\def\cadlag{c\`adl\`ag}
\def\ch{characteristic polynomial}
\def\chp{characteristic polynomial}
\def\coe{coefficient}
\def\comp{computation}
\def\con{condition}
\def\coo{coordinate}
\def\corr{corresponding}
\def\dec{decomposition}
\def\den{denominator}
\def\dete{deterministic}
\def\eig{eigenvalue}\def\eval{eigenvalue}
\def\eigv{eigenvector}\def\eiv{eigenvector}\def\evec{eigenvector}
\def\elt{element}
\def\enn{essentially nonnegative/positivity preserving}
\def\equ{equation}
\def\etal{et al.}
\def\fe{for example}
\def\fno{from now on}
\def\for{\forall}
\def\form{formula}
\def\Fr{Furthermore, }
\def\frt{furthermore}
\def\fun{function}
\def\gene{generalization}
\def\heu{heuristic}
\def\how{however}\def\How{However, }
\def\ie{i.e. }
\def\im{\item}
\def\isd{is defined by}
\def\itc{it is easy to check that}
\def\itf{it follows that}\def\Itf{It follows that}
\def\ith{it holds that}
\def\itm{it may be checked that}\def\Itm{It may be checked that}
\def\ito{it turns out that}\def\Ito{It turns out that}\def\Itou{It turns out useful to}
\def\ma{mass action}\def\MAR{mass action representation}
\def\mat{matrix}
\def\mbc{may be checked to be}
\def\mbw{may be written as}\def\mubw{must be written as}
\def\mpr{more precisely, }\def\Mp{More precisely, }
\def\nc{non-catalytic}
\def\nne{non-negative}\def\nny{nonnegativity}
\def\no{\nonumber}
\def\noni{non-infectious}
\def\nota{notation}
\def\np{\newpage}
\def\Nt{Note that}
\def\nt{non trivial}\def\nz{non zero}
\def\oth{otherwise}
\def\Oth{On the other hand}
\def\pa{parameter}\def\para{parameter}
\def\pol{polynomial}
\def\prob{probability}
\def\Prf{{\bf  Proof:}}\def\prf{{\bf  Proof:}}
\def\prop{proportional to}
\def\qu{\quad}
\def\QED{\hfill {$\square$}\goodbreak \medskip}
\def\rep{representation}
\def\resp{respectively}
\def\satd{satisfied}\def\satg{satisfying}\def\sats{satisfies}\def\saty{satisfy}
\def\sec{\section}\def\ssec{\subsection}\def\sssec{\subsubsection}
\def\sef{see for example}
\def\sksy{skew-symmetric}
\def\sub{substrate}
\def\sys{system}
\def\var{variable}
\def\wk{well-known}
\def\wl{without loss of generality}\def\wlo{w.l.o.g.}
\def\wmc{We may check that}\def\Wmc{We may check that}
\def\wmr{we may rewrite}
\def\wms{we must show that}
\def\wrt{with respect to}

% -- CRN & Chemistry --
\newcommand\CRN{chemical reaction networks}
\newcommand\CRNNoSpace{chemical reaction network}
\newcommand\CRNs{chemical reaction networks}
\newcommand\CRNsNoSpace{chemical reaction networks}
\newcommand\CRS{chemical reaction system}
\newcommand\CRSs{chemical reaction systems}
\newcommand\CRSsNoSpace{chemical reaction systems}
\newcommand\RN{reaction network}
\def\ACR{absolute concentration robustness}
\def\AMSD{acyclic siphon decomposition}
\def\DAE{differential algebraic equations}
\def\FHJ{Feinberg-Horn-Jackson}
\def\GMAK{generalized mass action kinetics}
\def\MM{Michaelis-Menten}
\def\sm{stoichiometric matrix}\def\Sm{stoichiometric matrix}
\def\WRZD{weakly reversible, zero deficiency}\def\aut{autocatalytic}

% -- Epidemiology --
\def\brn{basic reproduction number}\def\bzn{basic replacement number}
\def\com{compartment}
\def\dfe{disease free equilibrium}\def\DFE{disease free equilibrium}
\def\dwt{dwell times}\def\edt{expected dwell times}
\def\EM{epidemic model}
\def\endp{endemic fixed point}\def\enp{endemic point}\def\EE{endemic point}
\def\ME{mathematical epidemiology}
\def\MEE{eco-epidemiology}\def\EEP{eco-epidemiological}
\def\ece{eco-epidemiological model}
\def\mgm{multi group model}
\def\mtS{multi-strain model}\def\mSt{multi-strain model}
\def\mSi{minimal siphon}
\def\NGM{next generation matrix}
\def\nim{new infections matrix}
\def\qem{quadratic epidemiological model}
\def\repF{reproduction functions}
\def\SPF{SIR-PH-FA model}
\def\sus{susceptible}

% -- Graph theory & Linear algebra --
\def\jac{Jacobi matrix}
\def\jin{Jacobian matrix of the invasion vector field with respect to the invasion variables}
\def\jrn{Jacobian matrix of the resident vector field with respect to the resident variables}
\def\jxn{Jacobian matrix of the $\x$ vector field with respect to the $\x$ variables}
\def\Lm{Laplacian matrix}
\def\MTT{matrix tree theorem}
\def\SGT{spectral graph theory}
\def\SMW{Sherman–Morrison–Woodbury}

% -- Stability & Dynamics --
\def\absC{absorbtion CTMC}
\def\BTb{Bogdanov-Takens bifurcation}
\def\CEP{competitive exclusion principle}
\def\CTMC{continuous time Markov chain}
\def\ds{differential system}
\def\fp{fixed point}\def\bfp{boundary fixed point}\def\fbp{fixed boundary point}
\def\fbl{fixed boundary line}\def\fif{forward invariant face}
\def\gas{global asymptotic stability}\def\GAS{globally asymptotically stable}
\def\GASS{\text{GASS}}
\def\Hb{Hopf bifurcation}
\def\Hur{Hurwitz}\def\MH{Metzler-Hurwitz}\def\RH{Routh-Hurwitz}
\def\IS{\text{IS}}
\def\LAS{locally asymptotically stable}
\def\LdS{Lyapunov diagonally stable}
\def\Lf{Lyapunov function}\def\LyV{Lyapunov Volterra type function}\def\RLF{robust Lyapunov function}
\def\LyM{Lyapunov Malkin stable}
\def\PF{Perron-Frobenius}
\def\spfp{strictly positive fixed point}
\def\sta{stability}
\def\STP{sharp threshold property}\def\STT{sharp threshold theorem}

% -- Models (with \varphi explicitly instead of \f) --
\def\AB{$(A,B)$ Arino-Brauer epidemic models}
\def\ABa{$(A,\bbe,\ba,\varphi)$ balanced bilinear model}
\def\ABP{$(A,\bbe,P,\varphi)$ balanced bilinear model}
\def\AMG{Anderson May Gupta}
\newcommand\BIN{biological interaction network}
\def\Dt{Descartes type}
\def\gLV{generalized Lotka-Volterra model}
\def\IG{\text{invasion graph}}\def\IGMS{interaction graph on minimal siphons}
\def\LCP{\text{linear complementarity problem}}
\def\LV{Lotka-Volterra}\def\LVK{Lotka-Volterra-Kolmogorov}

% -- Splitting & Structure --
\def\reg{regular splitting}\def\regS{regular splitting}
\def\RUR{rational univariate representation}
\def\bds{block-diagonal structure}

% -- Miscellaneous --
\def\Ma{{Mathematica}}
\def\Mm{Max–Min}
\def\num{numerator}
\def\rap{rational approximation} \def\DSR{directed species reaction graph}