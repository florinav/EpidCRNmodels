In[2477]:=
In[2430]:=
In[2391]:=
ClearAll["Global`*"]
SetDirectory[NotebookDirectory[]];
SetOptions[$FrontEndSession, NotebookAutoSave -> True];
NotebookSave[];
AppendTo[$Path, FileNameJoin[{$HomeDirectory, "Dropbox", "EpidCRNmodels"}]];
<< EpidCRN`;

(* TEST ODE2RN - converts ODE to reaction network *)

(* Example 1: Reversible A <-> B *)
RHS1 = {-k1*a + k2*b, k1*a - k2*b};
var1 = {a, b};
{RN1, rts1, spe1, alp1, bet1, gam1} = ODE2RN[RHS1, var1];
Print["Ex1 A<->B: RN=", RN1, " rts=", rts1, " alp=", alp1, " bet=", bet1, " gam=", gam1];

(* Example 2: Birth-death *)
RHS2 = {La - mu*x};
var2 = {x};
{RN2, rts2, spe2, alp2, bet2, gam2} = ODE2RN[RHS2, var2];
Print["Ex2 birth-death: RN=", RN2, " rts=", rts2, " alp=", alp2, " bet=", bet2, " gam=", gam2];

(* Example 3: SIS model *)
RHS3 = {La - be*i*s - mu*s, be*i*s - (ga + mu)*i};
var3 = {s, i};
{RN3, rts3, spe3, alp3, bet3, gam3} = ODE2RN[RHS3, var3];
Print["Ex3 SIS: RN=", RN3, " rts=", rts3, " alp=", alp3, " bet=", bet3, " gam=", gam3];

(* Example 4: Lotka-Volterra *)
RHS4 = {a1*x - b1*x*y, -a2*y + b2*x*y};
var4 = {x, y};
{RN4, rts4, spe4, alp4, bet4, gam4} = ODE2RN[RHS4, var4];
Print["Ex4 LV: RN=", RN4, " rts=", rts4, " alp=", alp4, " bet=", bet4, " gam=", gam4];

(* Verify: gam.rts should equal RHS *)
Print["Ex1 verify: gam.rts-RHS=", Simplify[gam1.rts1 - RHS1]];
Print["Ex2 verify: gam.rts-RHS=", Simplify[gam2.rts2 - RHS2]];
Print["Ex3 verify: gam.rts-RHS=", Simplify[gam3.rts3 - RHS3]];
Print["Ex4 verify: gam.rts-RHS=", Simplify[gam4.rts4 - RHS4]];

During evaluation of In[2391]:= Ex1 A<->B: RN={b->a,a->b} rts={b k2,a k1} alp={{0,1},{1,0}} bet={{1,0},{0,1}} gam={{1,-1},{-1,1}}
During evaluation of In[2391]:= Ex2 birth-death: RN={0->x,x->0} rts={La,mu x} alp={{0,1}} bet={{1,0}} gam={{1,-1}}
During evaluation of In[2391]:= Ex3 SIS: RN={0->s,i+s->2i,s->0,i->0,i->0} rts={La,be i s,mu s,ga i,i mu} alp={{0,1,1,0,0},{0,1,0,1,1}} bet={{1,0,0,0,0},{0,2,0,0,0}} gam={{1,-1,-1,0,0},{0,1,0,-1,-1}}
During evaluation of In[2391]:= Ex4 LV: RN={x->2x,x+y->2y+x,x+y->y,y->0} rts={a1 x,b2 x y,b1 x y,a2 y} alp={{1,1,1,0},{0,1,1,1}} bet={{2,1,0,0},{0,2,1,0}} gam={{1,0,-1,0},{0,1,0,-1}}
During evaluation of In[2391]:= Ex1 verify: gam.rts-RHS={0,0}
During evaluation of In[2391]:= Ex2 verify: gam.rts-RHS={0}
During evaluation of In[2391]:= Ex3 verify: gam.rts-RHS={0,0}
During evaluation of In[2391]:= Ex4 verify: gam.rts-RHS={0,0}
During evaluation of In[2430]:= SetDelayed::write: Tag In in In[2391] is Protected.
Out[2430]= $Failed
During evaluation of In[2430]:= Ex1 A<->B: RN={b->a,a->b} rts={b k2,a k1} alp={{0,1},{1,0}} bet={{1,0},{0,1}} gam={{1,-1},{-1,1}}
During evaluation of In[2430]:= Ex2 birth-death: RN={0->x,x->0} rts={La,mu x} alp={{0,1}} bet={{1,0}} gam={{1,-1}}
During evaluation of In[2430]:= Ex3 SIS: RN={0->s,s+i->2i,s->0,i->-1i} rts={La,be i s,mu s,ga i+i mu} alp={{0,1,1,0},{0,1,0,1}} bet={{1,0,0,0},{0,2,0,-1}} gam={{1,-1,-1,0},{0,1,0,-2}}
During evaluation of In[2430]:= Ex4 LV: RN={x->2x,x+y->2y,y->0} rts={a1 x,b1 x y+b2 x y,a2 y} alp={{1,1,0},{0,1,1}} bet={{2,0,0},{0,2,0}} gam={{1,-1,0},{0,1,-1}}
During evaluation of In[2430]:= Ex1 verify: gam.rts-RHS={0,0}
During evaluation of In[2430]:= Ex2 verify: gam.rts-RHS={0}
During evaluation of In[2430]:= Ex3 verify: gam.rts-RHS={0,-i (ga+mu)}
During evaluation of In[2430]:= Ex4 verify: gam.rts-RHS={-b2 x y,b1 x y}
During evaluation of In[2430]:= SetDelayed::write: Tag Times in During evaluation Null of is Protected.
Out[2469]= $Failed
During evaluation of In[2430]:= SetDelayed::write: Tag Times in During evaluation Null of is Protected.
Out[2470]= $Failed
During evaluation of In[2430]:= SetDelayed::write: Tag Times in During evaluation Null of is Protected.
Out[2471]= $Failed
During evaluation of In[2430]:= SetDelayed::write: Tag Times in During evaluation Null of is Protected.
Out[2472]= $Failed
During evaluation of In[2430]:= SetDelayed::write: Tag Times in During evaluation Null of is Protected.
Out[2473]= $Failed
During evaluation of In[2430]:= SetDelayed::write: Tag Times in During evaluation Null of is Protected.
Out[2474]= $Failed
During evaluation of In[2430]:= SetDelayed::write: Tag Times in During evaluation Null of is Protected.
Out[2475]= $Failed
During evaluation of In[2430]:= SetDelayed::write: Tag Times in During evaluation Null of is Protected.
Out[2476]= $Failed
During evaluation of In[2477]:= SetDelayed::write: Tag In in In[2430] is Protected.
Out[2477]= $Failed
During evaluation of In[2477]:= Ex1 A<->B: RN={b->a,a->b} rts={b k2,a k1} alp={{0,1},{1,0}} bet={{1,0},{0,1}} gam={{1,-1},{-1,1}}
During evaluation of In[2477]:= Ex2 birth-death: RN={0->x,x->0} rts={La,mu x} alp={{0,1}} bet={{1,0}} gam={{1,-1}}
During evaluation of In[2477]:= Ex3 SIS: RN={0->s,s+i->2i,s->0,i->0} rts={La,be i s,mu s,ga i+i mu} alp={{0,1,1,0},{0,1,0,1}} bet={{1,0,0,0},{0,2,0,0}} gam={{1,-1,-1,0},{0,1,0,-1}}
During evaluation of In[2477]:= Ex4 LV: RN={x->2x,x+y->x+2y,x+y->y,y->0} rts={a1 x,b2 x y,b1 x y,a2 y} alp={{1,1,1,0},{0,1,1,1}} bet={{2,1,0,0},{0,2,1,0}} gam={{1,0,-1,0},{0,1,0,-1}}
During evaluation of In[2477]:= Ex1 verify: gam.rts-RHS={0,0}
During evaluation of In[2477]:= Ex2 verify: gam.rts-RHS={0}
During evaluation of In[2477]:= Ex3 verify: gam.rts-RHS={0,0}
During evaluation of In[2477]:= Ex4 verify: gam.rts-RHS={0,0}
During evaluation of In[2477]:= SetDelayed::write: Tag Times in During evaluation Null of is Protected.
Out[2516]= $Failed
During evaluation of In[2477]:= SetDelayed::write: Tag Times in During evaluation Null of is Protected.
Out[2517]= $Failed
During evaluation of In[2477]:= SetDelayed::write: Tag Times in During evaluation Null of is Protected.
Out[2518]= $Failed
During evaluation of In[2477]:= SetDelayed::write: Tag Times in During evaluation Null of is Protected.
Out[2519]= $Failed
During evaluation of In[2477]:= SetDelayed::write: Tag Times in During evaluation Null of is Protected.
Out[2520]= $Failed
During evaluation of In[2477]:= SetDelayed::write: Tag Times in During evaluation Null of is Protected.
Out[2521]= $Failed
During evaluation of In[2477]:= SetDelayed::write: Tag Times in During evaluation Null of is Protected.
Out[2522]= $Failed
During evaluation of In[2477]:= SetDelayed::write: Tag Times in During evaluation Null of is Protected.
Out[2523]= $Failed
During evaluation of In[2477]:=
Syntax::sntxf: 
   "" cannot be followed by "ectory[NotebookDirectory[]];".
During evaluation of In[2477]:= Set::write: Tag Times in in In is Null Tag Protected.$Failed is Protected.
Out[2524]= $Failed
During evaluation of In[2477]:= SetDelayed::write: Tag In in In[2391] is Protected.
During evaluation of In[2477]:= SetDelayed::write: Tag Times in During evaluation of $Failed is Protected.
Out[2525]= $Failed
During evaluation of In[2477]:= SetDelayed::write: Tag In in In[2391] is Protected.
During evaluation of In[2477]:= SetDelayed::write: Tag Times in During evaluation of $Failed is Protected.
Out[2526]= $Failed
During evaluation of In[2477]:= SetDelayed::write: Tag In in In[2391] is Protected.
During evaluation of In[2477]:= SetDelayed::write: Tag Times in During evaluation of $Failed is Protected.
Out[2527]= $Failed
During evaluation of In[2477]:= SetDelayed::write: Tag In in In[2391] is Protected.
During evaluation of In[2477]:= SetDelayed::write: Tag Times in During evaluation of $Failed is Protected.
Out[2528]= $Failed
During evaluation of In[2477]:= SetDelayed::write: Tag In in In[2391] is Protected.
During evaluation of In[2477]:= SetDelayed::write: Tag Times in During evaluation of $Failed is Protected.
Out[2529]= $Failed
During evaluation of In[2477]:= SetDelayed::write: Tag In in In[2391] is Protected.
During evaluation of In[2477]:= SetDelayed::write: Tag Times in During evaluation of $Failed is Protected.
Out[2530]= $Failed
During evaluation of In[2477]:= SetDelayed::write: Tag In in In[2391] is Protected.
During evaluation of In[2477]:= SetDelayed::write: Tag Times in During evaluation of $Failed is Protected.
Out[2531]= $Failed
During evaluation of In[2477]:= SetDelayed::write: Tag In in In[2391] is Protected.
During evaluation of In[2477]:= SetDelayed::write: Tag Times in During evaluation of $Failed is Protected.
Out[2532]= $Failed
During evaluation of In[2477]:=
Syntax::sntxf: 
   "" cannot be followed by "ectory[NotebookDirectory[]];".
During evaluation of In[2477]:= Set::write: Tag Times in During evaluation in is Null of Tag Times Protected.$Failed is Protected.
Out[2533]= $Failed
During evaluation of In[2477]:=
Syntax::sntxf: 
   "" cannot be followed by "ectory[NotebookDirectory[]];".
During evaluation of In[2477]:= Set::write: Tag Times in During evaluation in is Null of Tag Times Protected.$Failed is Protected.
Out[2534]= $Failed
During evaluation of In[2477]:=
Syntax::sntxf: 
   "" cannot be followed by "ectory[NotebookDirectory[]];".
During evaluation of In[2477]:= Set::write: Tag Times in During evaluation in is Null of Tag Times Protected.$Failed is Protected.
Out[2535]= $Failed
During evaluation of In[2477]:=
Syntax::sntxf: 
   "" cannot be followed by "ectory[NotebookDirectory[]];".
During evaluation of In[2477]:= Set::write: Tag Times in During evaluation in is Null of Tag Times Protected.$Failed is Protected.
Out[2536]= $Failed
During evaluation of In[2477]:=
Syntax::sntxf: 
   "" cannot be followed by "ectory[NotebookDirectory[]];".
During evaluation of In[2477]:= Set::write: Tag Times in During evaluation in is Null of Tag Times Protected.$Failed is Protected.
Out[2537]= $Failed
During evaluation of In[2477]:=
Syntax::sntxf: 
   "" cannot be followed by "ectory[NotebookDirectory[]];".
During evaluation of In[2477]:= Set::write: Tag Times in During evaluation in is Null of Tag Times Protected.$Failed is Protected.
Out[2538]= $Failed
During evaluation of In[2477]:=
Syntax::sntxf: 
   "" cannot be followed by "ectory[NotebookDirectory[]];".
During evaluation of In[2477]:= Set::write: Tag Times in During evaluation in is Null of Tag Times Protected.$Failed is Protected.
Out[2539]= $Failed
During evaluation of In[2477]:=
Syntax::sntxf: 
   "" cannot be followed by "ectory[NotebookDirectory[]];".
During evaluation of In[2477]:= Set::write: Tag Times in During evaluation in is Null of Tag Times Protected.$Failed is Protected.
Out[2540]= $Failed