(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     47485,       1117]
NotebookOptionsPosition[     45405,       1082]
NotebookOutlinePosition[     45849,       1098]
CellTagsIndexPosition[     45806,       1095]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"ACK", " ", "multiscale", " ", "Analysis"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ACK", "[", 
      RowBox[{"RN_", ",", "continuousSpeciesIndices_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "species", ",", "continuous", ",", "discrete", ",", "discreteRN", ",",
          "continuousRN", ",", "reaction", ",", "left", ",", "right", ",", 
         "discreteLeft", ",", "discreteRight", ",", "continuousLeft", ",", 
         "continuousRight", ",", "poissonParam", ",", "continuousODE"}], 
        "}"}], ",", 
       RowBox[{"(*", 
        RowBox[{"Extract", " ", "and", " ", "partition", " ", "species"}], 
        "*)"}], 
       RowBox[{
        RowBox[{"species", "=", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Cases", "[", 
            RowBox[{"RN", ",", "_String", ",", "Infinity"}], "]"}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"continuous", "=", 
         RowBox[{"species", "[", 
          RowBox[{"[", "continuousSpeciesIndices", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"discrete", "=", 
         RowBox[{"Complement", "[", 
          RowBox[{"species", ",", "continuous"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Helper", " ", "function", " ", "to", " ", "remove", " ", "entire", 
          " ", "terms", " ", "containing", " ", "discrete", " ", "species"}], 
         "*)"}], 
        RowBox[{
         RowBox[{"removeDiscreteTerms", "[", "expr_", "]"}], ":=", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", "terms", "}"}], ",", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"expr", "===", "0"}], ",", 
              RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Head", "[", "expr", "]"}], "===", "Plus"}], ",", 
              RowBox[{
               RowBox[{"terms", "=", 
                RowBox[{"List", "@@", "expr"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"terms", "=", 
                RowBox[{"Select", "[", 
                 RowBox[{"terms", ",", 
                  RowBox[{
                   RowBox[{"FreeQ", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"Alternatives", "@@", "discrete"}]}], "]"}], 
                   "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", "terms", "]"}], "==", "0"}], ",", 
                 RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", "terms", "]"}], "==", "1"}], ",", 
                 RowBox[{"Return", "[", 
                  RowBox[{"terms", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Return", "[", 
                RowBox[{"Plus", "@@", "terms"}], "]"}], ";"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"FreeQ", "[", 
               RowBox[{"expr", ",", 
                RowBox[{"Alternatives", "@@", "discrete"}]}], "]"}], ",", 
              RowBox[{"Return", "[", "expr", "]"}], ",", 
              RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Helper", " ", "function", " ", "to", " ", "remove", " ", "entire", 
          " ", "terms", " ", "containing", " ", "continuous", " ", 
          "species"}], "*)"}], 
        RowBox[{
         RowBox[{"removeContinuousTerms", "[", "expr_", "]"}], ":=", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", "terms", "}"}], ",", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"expr", "===", "0"}], ",", 
              RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Head", "[", "expr", "]"}], "===", "Plus"}], ",", 
              RowBox[{
               RowBox[{"terms", "=", 
                RowBox[{"List", "@@", "expr"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"terms", "=", 
                RowBox[{"Select", "[", 
                 RowBox[{"terms", ",", 
                  RowBox[{
                   RowBox[{"FreeQ", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"Alternatives", "@@", "continuous"}]}], "]"}], 
                   "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", "terms", "]"}], "==", "0"}], ",", 
                 RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", "terms", "]"}], "==", "1"}], ",", 
                 RowBox[{"Return", "[", 
                  RowBox[{"terms", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Return", "[", 
                RowBox[{"Plus", "@@", "terms"}], "]"}], ";"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"FreeQ", "[", 
               RowBox[{"expr", ",", 
                RowBox[{"Alternatives", "@@", "continuous"}]}], "]"}], ",", 
              RowBox[{"Return", "[", "expr", "]"}], ",", 
              RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", "Initialize", "*)"}], 
        RowBox[{"discreteRN", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"continuousRN", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Process", " ", "each", " ", "reaction"}], "*)"}], 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"reaction", "=", 
            RowBox[{"RN", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"left", "=", 
            RowBox[{"reaction", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"right", "=", 
            RowBox[{"reaction", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"DISCRETE", " ", "PROJECTION"}], "*)"}], 
           RowBox[{"discreteLeft", "=", 
            RowBox[{"removeContinuousTerms", "[", "left", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"discreteRight", "=", 
            RowBox[{"removeContinuousTerms", "[", "right", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
             "Add", " ", "to", " ", "discrete", " ", "network", " ", "if", 
              " ", "different", " ", "and", " ", "not", " ", "0"}], "->", 
             "0"}], "*)"}], 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"discreteLeft", "=!=", "discreteRight"}], "&&", 
              RowBox[{"!", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"discreteLeft", "===", "0"}], "&&", 
                 RowBox[{"discreteRight", "===", "0"}]}], ")"}]}]}], ",", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"discreteRN", ",", 
                RowBox[{"discreteLeft", "->", "discreteRight"}]}], "]"}], 
              ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"CONTINUOUS", " ", "PROJECTION"}], "*)"}], 
           RowBox[{"continuousLeft", "=", 
            RowBox[{"removeDiscreteTerms", "[", "left", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"continuousRight", "=", 
            RowBox[{"removeDiscreteTerms", "[", "right", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
             "Add", " ", "to", " ", "continuous", " ", "network", " ", "if", 
              " ", "different", " ", "and", " ", "not", " ", "0"}], "->", 
             "0"}], "*)"}], 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"continuousLeft", "=!=", "continuousRight"}], "&&", 
              RowBox[{"!", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"continuousLeft", "===", "0"}], "&&", 
                 RowBox[{"continuousRight", "===", "0"}]}], ")"}]}]}], ",", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"continuousRN", ",", 
                RowBox[{"continuousLeft", "->", "continuousRight"}]}], "]"}], 
              ";"}]}], "]"}], ";"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "RN", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Remove", " ", "duplicates"}], "*)"}], 
        RowBox[{"discreteRN", "=", 
         RowBox[{"DeleteDuplicates", "[", "discreteRN", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"continuousRN", "=", 
         RowBox[{"DeleteDuplicates", "[", "continuousRN", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Determine", " ", "Poisson", " ", "parameter"}], "*)"}], 
        RowBox[{
        "poissonParam", "=", "\"\<Solve detailed balance equations\>\""}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ContainsAll", "[", 
            RowBox[{"discreteRN", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<A\>\"", "->", 
                RowBox[{"2", "*", "\"\<A\>\""}]}], ",", 
               RowBox[{
                RowBox[{"2", "*", "\"\<A\>\""}], "->", "\"\<A\>\""}]}], 
              "}"}]}], "]"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"discreteRN", ",", 
               RowBox[{"0", "->", "\"\<A\>\""}]}], "]"}], "||", 
             RowBox[{"MemberQ", "[", 
              RowBox[{"discreteRN", ",", 
               RowBox[{"\"\<A\>\"", "->", "0"}]}], "]"}]}], ")"}]}], ",", 
          RowBox[{
           RowBox[{
           "poissonParam", "=", 
            "\"\<\[Kappa]\:2084/\[Kappa]\:2082 (from complex balance, w terms \
cancel)\>\""}], ";"}], ",", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Check", " ", "for", " ", "birth"}], "-", 
            RowBox[{"death", " ", "pattern", " ", "like", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"2", "A"}], "->", "0"}], ",", 
               RowBox[{"0", "->", "A"}]}], "}"}], " ", "or", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"A", "->", "0"}], ",", 
               RowBox[{"0", "->", "A"}]}], "}"}]}]}], "*)"}], 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "discrete", "]"}], "==", "1"}], "&&", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{"discreteRN", ",", 
                  RowBox[{
                   RowBox[{"2", "*", 
                    RowBox[{"discrete", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "->", "0"}]}], "]"}], "||", 
                RowBox[{"MemberQ", "[", 
                 RowBox[{"discreteRN", ",", 
                  RowBox[{
                   RowBox[{"discrete", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "->", "0"}]}], "]"}]}], 
               ")"}], "&&", 
              RowBox[{"MemberQ", "[", 
               RowBox[{"discreteRN", ",", 
                RowBox[{"0", "->", 
                 RowBox[{"discrete", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}]}], ",", 
             RowBox[{
              RowBox[{
              "poissonParam", "=", 
               "\"\<Birth-death equilibrium (NOT Poisson for 2A->0 pattern)\>\
\""}], ";"}], ",", 
             RowBox[{
              RowBox[{
              "poissonParam", "=", "\"\<Complex network equilibrium\>\""}], 
              ";"}]}], "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Generate", " ", "continuous", " ", "ODE", " ", "based", " ", "on", 
          " ", "actual", " ", "continuous", " ", "species", " ", "and", " ", 
          "network"}], "*)"}], 
        RowBox[{"continuousODE", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "continuous", "]"}], ">", "0"}], "&&", 
           RowBox[{
            RowBox[{"Length", "[", "continuousRN", "]"}], ">", "0"}]}], ",", 
          RowBox[{
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Module", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"terms", "=", 
                  RowBox[{"{", "}"}]}], "}"}], ",", 
                RowBox[{
                 RowBox[{"Do", "[", 
                  RowBox[{"(*", 
                   RowBox[{
                   "Calculate", " ", "net", " ", "stoichiometric", " ", 
                    "coefficient", " ", "for", " ", "this", " ", "species", 
                    " ", "in", " ", "this", " ", "reaction"}], "*)"}], 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "leftSide", ",", "rightSide", ",", "leftCoeff", ",", 
                    "rightCoeff", ",", "netChange", ",", "rateExpr"}], "}"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"leftSide", "=", 
                    RowBox[{"continuousRN", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"rightSide", "=", 
                    RowBox[{"continuousRN", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "2"}], "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Count", " ", "occurrences", " ", "of", " ", "this", " ", 
                    "species", " ", "on", " ", "each", " ", "side"}], "*)"}], 
                    RowBox[{"leftCoeff", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"leftSide", "===", "0"}], ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Head", "[", "leftSide", "]"}], "===", "Plus"}], 
                    ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{"List", "@@", "leftSide"}], ",", 
                    RowBox[{
                    RowBox[{"x_", "/;", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", "===", 
                    RowBox[{"continuous", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "||", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Head", "[", "x", "]"}], "===", "Times"}], "&&", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"continuous", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ")"}]}], 
                    ")"}]}], ":>", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Head", "[", "x", "]"}], "===", "Times"}], ",", 
                    RowBox[{
                    RowBox[{"Cases", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"_", "?", "NumericQ"}]}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}]}]}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"leftSide", "===", 
                    RowBox[{"continuous", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ",", "1", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Head", "[", "leftSide", "]"}], "===", "Times"}], 
                    "&&", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"leftSide", ",", 
                    RowBox[{"continuous", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cases", "[", 
                    RowBox[{"leftSide", ",", 
                    RowBox[{"_", "?", "NumericQ"}]}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "]"}]}], 
                    "]"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"rightCoeff", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"rightSide", "===", "0"}], ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Head", "[", "rightSide", "]"}], "===", "Plus"}], 
                    ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{"List", "@@", "rightSide"}], ",", 
                    RowBox[{
                    RowBox[{"x_", "/;", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", "===", 
                    RowBox[{"continuous", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "||", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Head", "[", "x", "]"}], "===", "Times"}], "&&", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"continuous", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ")"}]}], 
                    ")"}]}], ":>", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Head", "[", "x", "]"}], "===", "Times"}], ",", 
                    RowBox[{
                    RowBox[{"Cases", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"_", "?", "NumericQ"}]}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}]}]}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"rightSide", "===", 
                    RowBox[{"continuous", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ",", "1", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Head", "[", "rightSide", "]"}], "===", "Times"}],
                     "&&", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"rightSide", ",", 
                    RowBox[{"continuous", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cases", "[", 
                    RowBox[{"rightSide", ",", 
                    RowBox[{"_", "?", "NumericQ"}]}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "]"}]}], 
                    "]"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"netChange", "=", 
                    RowBox[{"rightCoeff", "-", "leftCoeff"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"netChange", "!=", "0"}], ",", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Build", " ", "rate", " ", "expression"}], "-", 
                    RowBox[{"simplified", " ", "for", " ", "now"}]}], "*)"}], 
                    RowBox[{
                    RowBox[{"rateExpr", "=", 
                    RowBox[{"\"\<\[Kappa]\>\"", "<>", 
                    RowBox[{"ToString", "[", "j", "]"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "discrete", "]"}], ">", "0"}], ",", 
                    RowBox[{"rateExpr", "=", 
                    RowBox[{"rateExpr", "<>", "\"\<*q\:0304\>\""}]}]}], "]"}],
                     ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Add", " ", "substrate", " ", "dependencies"}], 
                    "*)"}], 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"leftSide", "=!=", "0"}], ",", 
                    RowBox[{
                    RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", "substrates", "}"}], ",", 
                    RowBox[{
                    RowBox[{"substrates", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Head", "[", "leftSide", "]"}], "===", "Plus"}], 
                    ",", 
                    RowBox[{"List", "@@", "leftSide"}], ",", 
                    RowBox[{"{", "leftSide", "}"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"continuous", ",", "substrate"}], "]"}], "||", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Head", "[", "substrate", "]"}], "===", "Times"}],
                     "&&", 
                    RowBox[{"AnyTrue", "[", 
                    RowBox[{"substrate", ",", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"continuous", ",", "#"}], "]"}], "&"}]}], "]"}]}],
                     ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"rateExpr", "=", 
                    RowBox[{"rateExpr", "<>", "\"\<*\>\"", "<>", 
                    RowBox[{"continuous", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Break", "[", "]"}], ";"}]}], "]"}], ";"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"substrate", ",", "substrates"}], "}"}]}], "]"}], 
                    ";"}]}], "]"}], ";"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"terms", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"netChange", ">", "0"}], ",", "\"\<+\>\"", ",", 
                    "\"\<\>\""}], "]"}], "<>", 
                    RowBox[{"ToString", "[", "netChange", "]"}], "<>", 
                    "\"\<*(\>\"", "<>", "rateExpr", "<>", "\"\<)\>\""}]}], 
                    "]"}], ";"}]}], "]"}], ";"}]}], "]"}], ";"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"Length", "[", "continuousRN", "]"}]}], "}"}]}], 
                  "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"Module", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"odeExpr", ",", "simplified"}], "}"}], ",", 
                   RowBox[{
                    RowBox[{"odeExpr", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "terms", "]"}], ">", "0"}], ",", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{
                    RowBox[{"StringRiffle", "[", 
                    RowBox[{"terms", ",", "\"\< \>\""}], "]"}], ",", 
                    RowBox[{"\"\<+-\>\"", "->", "\"\<-\>\""}]}], "]"}], ",", 
                    "\"\<0\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"simplified", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringContainsQ", "[", 
                    RowBox[{"poissonParam", ",", "\"\<complex balance\>\""}], 
                    "]"}], "||", 
                    RowBox[{"StringContainsQ", "[", 
                    RowBox[{
                    "poissonParam", ",", 
                    "\"\<\[Kappa]\:2084/\[Kappa]\:2082\>\""}], "]"}]}], ",", 
                    "\"\< = 0 (after CBE)\>\"", ",", "\"\<\>\""}], "]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"continuousODE", ",", 
                    RowBox[{
                    RowBox[{"continuous", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "<>", "\"\<' = \>\"", "<>",
                     "odeExpr", "<>", "simplified"}]}], "]"}], ";"}]}], "]"}],
                  ";"}]}], "]"}], ";"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "continuous", "]"}]}], "}"}]}], "]"}], 
           ";"}], ",", 
          RowBox[{
           RowBox[{"continuousODE", "=", 
            RowBox[{
            "{", "\"\<No continuous species or reactions\>\"", "}"}]}], 
           ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Return", " ", "four", " ", "outputs", " ", "as", " ", "list"}], 
         "*)"}], 
        RowBox[{"{", 
         RowBox[{
         "discreteRN", ",", "continuousRN", ",", "continuousODE", ",", 
          "poissonParam"}], "}"}]}]}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Test", " ", "examples"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Example", " ", "1"}], ":", 
     RowBox[{"SI", " ", "Model"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<=== SI MODEL TEST ===\>\"", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"RN", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"\"\<S\>\"", "+", "\"\<I\>\""}], "->", 
        RowBox[{"2", "*", "\"\<I\>\""}]}], ",", 
       RowBox[{"\"\<I\>\"", "->", "\"\<S\>\""}]}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"result", "=", 
     RowBox[{"ACK", "[", 
      RowBox[{"RN", ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"I", " ", "is", " ", "continuous"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Discrete network: \>\"", ",", 
      RowBox[{"result", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Continuous network: \>\"", ",", 
      RowBox[{"result", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Continuous ODE: \>\"", ",", 
      RowBox[{"result", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Poisson parameter: \>\"", ",", 
      RowBox[{"result", "[", 
       RowBox[{"[", "4", "]"}], "]"}]}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", "]"}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Example", " ", "2"}], ":", 
     RowBox[{"Non", "-", 
      RowBox[{"Poisson", " ", "ACR"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<=== NON-POISSON ACR TEST ===\>\"", "]"}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"RN", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"2", "*", "\"\<A\>\""}], "+", "\"\<B\>\""}], "->", 
        RowBox[{"3", "*", "\"\<B\>\""}]}], ",", 
       RowBox[{"\"\<B\>\"", "->", "\"\<A\>\""}]}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"result", "=", 
     RowBox[{"ACK", "[", 
      RowBox[{"RN", ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"B", " ", "is", " ", "continuous"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Discrete network: \>\"", ",", 
      RowBox[{"result", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Continuous network: \>\"", ",", 
      RowBox[{"result", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Continuous ODE: \>\"", ",", 
      RowBox[{"result", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Poisson parameter: \>\"", ",", 
      RowBox[{"result", "[", 
       RowBox[{"[", "4", "]"}], "]"}]}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", "]"}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Example", " ", "3"}], ":", 
     RowBox[{"Complex", " ", "ACR"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<=== COMPLEX ACR TEST ===\>\"", "]"}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{"RN", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"\"\<A\>\"", "+", "\"\<B\>\""}], "->", 
        RowBox[{
         RowBox[{"2", "*", "\"\<A\>\""}], "+", "\"\<C\>\""}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"2", "*", "\"\<A\>\""}], "+", "\"\<C\>\""}], "->", 
        RowBox[{"\"\<A\>\"", "+", "\"\<D\>\""}]}], ",", 
       RowBox[{"\"\<B\>\"", "->", 
        RowBox[{"\"\<A\>\"", "+", "\"\<D\>\""}]}], ",", 
       RowBox[{
        RowBox[{"\"\<A\>\"", "+", "\"\<C\>\""}], "->", "\"\<B\>\""}], ",", 
       RowBox[{"\"\<D\>\"", "->", "\"\<B\>\""}], ",", 
       RowBox[{"\"\<D\>\"", "->", "\"\<C\>\""}]}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"result", "=", 
     RowBox[{"ACK", "[", 
      RowBox[{"RN", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3", ",", "4"}], "}"}]}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"B", ",", "C", ",", 
     RowBox[{"D", " ", "are", " ", "continuous"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Discrete network: \>\"", ",", 
      RowBox[{"result", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Continuous network: \>\"", ",", 
      RowBox[{"result", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Continuous ODE: \>\"", ",", 
      RowBox[{"result", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Poisson parameter: \>\"", ",", 
      RowBox[{"result", "[", 
       RowBox[{"[", "4", "]"}], "]"}]}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.9599278202156477`*^9, 3.959927856919216*^9}, 
   3.9599285183732204`*^9, {3.9599287097441893`*^9, 3.9599287459029803`*^9}, {
   3.959928776229429*^9, 3.959928776261368*^9}, 3.9599289558010483`*^9, 
   3.959929058266965*^9, 3.9599291791185265`*^9, {3.9599296741143417`*^9, 
   3.9599297050411243`*^9}, 3.959929880775151*^9, {3.959930171338827*^9, 
   3.959930180853883*^9}, 3.959940048958061*^9, 3.959940086023844*^9, {
   3.9599402282927265`*^9, 3.9599402360476236`*^9}, {3.9599413718880777`*^9, 
   3.959941406681872*^9}, {3.959941811283576*^9, 3.959941847845496*^9}},
 CellLabel->
  "In[290]:=",ExpressionUUID->"27c6ce13-724c-4d12-bcac-1caba2095556"],

Cell[CellGroupData[{

Cell[BoxData["\<\"=== SI MODEL TEST ===\"\>"], "Print",
 CellChangeTimes->{
  3.959929711712248*^9, 3.959929882935876*^9, 3.9599301816943336`*^9, 
   3.9599400518864875`*^9, 3.959940091390383*^9, 3.959940238070239*^9, 
   3.959941407893716*^9, {3.9599418311996365`*^9, 3.959941859429424*^9}},
 CellLabel->
  "During evaluation of \
In[290]:=",ExpressionUUID->"c16573cf-4404-411f-877e-cb84fc7baac8"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Discrete network: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\<\"I\"\>", "\[Rule]", 
      RowBox[{"2", " ", "\<\"I\"\>"}]}], ",", 
     RowBox[{"\<\"I\"\>", "\[Rule]", "0"}]}], "}"}]}],
  SequenceForm["Discrete network: ", {"I" -> 2 "I", "I" -> 0}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.959929711712248*^9, 3.959929882935876*^9, 3.9599301816943336`*^9, 
   3.9599400518864875`*^9, 3.959940091390383*^9, 3.959940238070239*^9, 
   3.959941407893716*^9, {3.9599418311996365`*^9, 3.959941859457092*^9}},
 CellLabel->
  "During evaluation of \
In[290]:=",ExpressionUUID->"0a8fab3e-3066-4742-ac2a-e38362185343"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Continuous network: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\<\"S\"\>", "\[Rule]", "0"}], ",", 
     RowBox[{"0", "\[Rule]", "\<\"S\"\>"}]}], "}"}]}],
  SequenceForm["Continuous network: ", {"S" -> 0, 0 -> "S"}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.959929711712248*^9, 3.959929882935876*^9, 3.9599301816943336`*^9, 
   3.9599400518864875`*^9, 3.959940091390383*^9, 3.959940238070239*^9, 
   3.959941407893716*^9, {3.9599418311996365`*^9, 3.959941859490139*^9}},
 CellLabel->
  "During evaluation of \
In[290]:=",ExpressionUUID->"715b65a1-a4a4-494b-8d7c-ab354dea6aff"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Continuous ODE: \"\>", "\[InvisibleSpace]", 
   RowBox[{
   "{", "\<\"S' = -1*(\[Kappa]1*q\:0304*S) +1*(\[Kappa]2*q\:0304)\"\>", 
    "}"}]}],
  SequenceForm[
  "Continuous ODE: ", {
   "S' = -1*(\[Kappa]1*q\:0304*S) +1*(\[Kappa]2*q\:0304)"}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.959929711712248*^9, 3.959929882935876*^9, 3.9599301816943336`*^9, 
   3.9599400518864875`*^9, 3.959940091390383*^9, 3.959940238070239*^9, 
   3.959941407893716*^9, {3.9599418311996365`*^9, 3.959941859542224*^9}},
 CellLabel->
  "During evaluation of \
In[290]:=",ExpressionUUID->"52d10561-3f60-4423-aedd-2113f02d3620"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Poisson parameter: \"\>", 
   "\[InvisibleSpace]", "\<\"Complex network equilibrium\"\>"}],
  SequenceForm["Poisson parameter: ", "Complex network equilibrium"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.959929711712248*^9, 3.959929882935876*^9, 3.9599301816943336`*^9, 
   3.9599400518864875`*^9, 3.959940091390383*^9, 3.959940238070239*^9, 
   3.959941407893716*^9, {3.9599418311996365`*^9, 3.959941859597047*^9}},
 CellLabel->
  "During evaluation of \
In[290]:=",ExpressionUUID->"82510cf4-fbde-4488-a594-1bcc6a0a4d83"],

Cell[BoxData["\<\"\"\>"], "Print",
 CellChangeTimes->{
  3.959929711712248*^9, 3.959929882935876*^9, 3.9599301816943336`*^9, 
   3.9599400518864875`*^9, 3.959940091390383*^9, 3.959940238070239*^9, 
   3.959941407893716*^9, {3.9599418311996365`*^9, 3.959941859648677*^9}},
 CellLabel->
  "During evaluation of \
In[290]:=",ExpressionUUID->"112bf1e2-5d4b-4a68-bbba-20092d2a5828"],

Cell[BoxData["\<\"=== NON-POISSON ACR TEST ===\"\>"], "Print",
 CellChangeTimes->{
  3.959929711712248*^9, 3.959929882935876*^9, 3.9599301816943336`*^9, 
   3.9599400518864875`*^9, 3.959940091390383*^9, 3.959940238070239*^9, 
   3.959941407893716*^9, {3.9599418311996365`*^9, 3.9599418597070785`*^9}},
 CellLabel->
  "During evaluation of \
In[290]:=",ExpressionUUID->"75ee001e-db21-498a-97b8-472e8bf66984"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Discrete network: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"2", " ", "\<\"A\"\>"}], "\[Rule]", "0"}], ",", 
     RowBox[{"0", "\[Rule]", "\<\"A\"\>"}]}], "}"}]}],
  SequenceForm["Discrete network: ", {2 "A" -> 0, 0 -> "A"}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.959929711712248*^9, 3.959929882935876*^9, 3.9599301816943336`*^9, 
   3.9599400518864875`*^9, 3.959940091390383*^9, 3.959940238070239*^9, 
   3.959941407893716*^9, {3.9599418311996365`*^9, 3.959941859766193*^9}},
 CellLabel->
  "During evaluation of \
In[290]:=",ExpressionUUID->"df3d343f-68d3-4290-8a7e-90fac9b5f830"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Continuous network: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\<\"B\"\>", "\[Rule]", 
      RowBox[{"3", " ", "\<\"B\"\>"}]}], ",", 
     RowBox[{"\<\"B\"\>", "\[Rule]", "0"}]}], "}"}]}],
  SequenceForm["Continuous network: ", {"B" -> 3 "B", "B" -> 0}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.959929711712248*^9, 3.959929882935876*^9, 3.9599301816943336`*^9, 
   3.9599400518864875`*^9, 3.959940091390383*^9, 3.959940238070239*^9, 
   3.959941407893716*^9, {3.9599418311996365`*^9, 3.959941859832367*^9}},
 CellLabel->
  "During evaluation of \
In[290]:=",ExpressionUUID->"58afa3dd-dfbb-4043-8a49-add9f67ea7ca"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Continuous ODE: \"\>", "\[InvisibleSpace]", 
   RowBox[{
   "{", "\<\"B' = +2*(\[Kappa]1*q\:0304*B) -1*(\[Kappa]2*q\:0304*B)\"\>", 
    "}"}]}],
  SequenceForm[
  "Continuous ODE: ", {
   "B' = +2*(\[Kappa]1*q\:0304*B) -1*(\[Kappa]2*q\:0304*B)"}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.959929711712248*^9, 3.959929882935876*^9, 3.9599301816943336`*^9, 
   3.9599400518864875`*^9, 3.959940091390383*^9, 3.959940238070239*^9, 
   3.959941407893716*^9, {3.9599418311996365`*^9, 3.9599418599003305`*^9}},
 CellLabel->
  "During evaluation of \
In[290]:=",ExpressionUUID->"a7b40267-ecd7-4849-9d0a-76fcf1b6bc2c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Poisson parameter: \"\>", 
   "\[InvisibleSpace]", "\<\"Birth-death equilibrium (NOT Poisson for 2A->0 \
pattern)\"\>"}],
  SequenceForm[
  "Poisson parameter: ", 
   "Birth-death equilibrium (NOT Poisson for 2A->0 pattern)"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.959929711712248*^9, 3.959929882935876*^9, 3.9599301816943336`*^9, 
   3.9599400518864875`*^9, 3.959940091390383*^9, 3.959940238070239*^9, 
   3.959941407893716*^9, {3.9599418311996365`*^9, 3.959941859954398*^9}},
 CellLabel->
  "During evaluation of \
In[290]:=",ExpressionUUID->"6311eeee-ad52-452c-8da1-ee7e36208a8e"],

Cell[BoxData["\<\"\"\>"], "Print",
 CellChangeTimes->{
  3.959929711712248*^9, 3.959929882935876*^9, 3.9599301816943336`*^9, 
   3.9599400518864875`*^9, 3.959940091390383*^9, 3.959940238070239*^9, 
   3.959941407893716*^9, {3.9599418311996365`*^9, 3.959941860026828*^9}},
 CellLabel->
  "During evaluation of \
In[290]:=",ExpressionUUID->"7529f4f2-ce48-44e0-a45b-1781edea1827"],

Cell[BoxData["\<\"=== COMPLEX ACR TEST ===\"\>"], "Print",
 CellChangeTimes->{
  3.959929711712248*^9, 3.959929882935876*^9, 3.9599301816943336`*^9, 
   3.9599400518864875`*^9, 3.959940091390383*^9, 3.959940238070239*^9, 
   3.959941407893716*^9, {3.9599418311996365`*^9, 3.9599418600754347`*^9}},
 CellLabel->
  "During evaluation of \
In[290]:=",ExpressionUUID->"30d2bdfe-d4a9-4945-93f0-60b42d395986"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Discrete network: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\<\"A\"\>", "\[Rule]", 
      RowBox[{"2", " ", "\<\"A\"\>"}]}], ",", 
     RowBox[{
      RowBox[{"2", " ", "\<\"A\"\>"}], "\[Rule]", "\<\"A\"\>"}], ",", 
     RowBox[{"0", "\[Rule]", "\<\"A\"\>"}], ",", 
     RowBox[{"\<\"A\"\>", "\[Rule]", "0"}]}], "}"}]}],
  SequenceForm[
  "Discrete network: ", {"A" -> 2 "A", 2 "A" -> "A", 0 -> "A", "A" -> 0}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.959929711712248*^9, 3.959929882935876*^9, 3.9599301816943336`*^9, 
   3.9599400518864875`*^9, 3.959940091390383*^9, 3.959940238070239*^9, 
   3.959941407893716*^9, {3.9599418311996365`*^9, 3.959941860144431*^9}},
 CellLabel->
  "During evaluation of \
In[290]:=",ExpressionUUID->"026739a0-a489-4efa-9aa3-c2549d3ae37e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Continuous network: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\<\"B\"\>", "\[Rule]", "\<\"C\"\>"}], ",", 
     RowBox[{"\<\"C\"\>", "\[Rule]", "\<\"D\"\>"}], ",", 
     RowBox[{"\<\"B\"\>", "\[Rule]", "\<\"D\"\>"}], ",", 
     RowBox[{"\<\"C\"\>", "\[Rule]", "\<\"B\"\>"}], ",", 
     RowBox[{"\<\"D\"\>", "\[Rule]", "\<\"B\"\>"}], ",", 
     RowBox[{"\<\"D\"\>", "\[Rule]", "\<\"C\"\>"}]}], "}"}]}],
  SequenceForm[
  "Continuous network: ", {
   "B" -> "C", "C" -> "D", "B" -> "D", "C" -> "B", "D" -> "B", "D" -> "C"}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.959929711712248*^9, 3.959929882935876*^9, 3.9599301816943336`*^9, 
   3.9599400518864875`*^9, 3.959940091390383*^9, 3.959940238070239*^9, 
   3.959941407893716*^9, {3.9599418311996365`*^9, 3.959941860220153*^9}},
 CellLabel->
  "During evaluation of \
In[290]:=",ExpressionUUID->"4e1ba119-fef7-401b-8665-47b1cd0bddbb"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Continuous ODE: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"\<\"B' = -1*(\[Kappa]1*q\:0304*B) -1*(\[Kappa]3*q\:0304*B) +1*(\
\[Kappa]4*q\:0304*B) +1*(\[Kappa]5*q\:0304*B) = 0 (after CBE)\"\>", 
     ",", "\<\"C' = +1*(\[Kappa]1*q\:0304*C) -1*(\[Kappa]2*q\:0304*C) -1*(\
\[Kappa]4*q\:0304*C) +1*(\[Kappa]6*q\:0304*C) = 0 (after CBE)\"\>", 
     ",", "\<\"D' = +1*(\[Kappa]2*q\:0304*D) +1*(\[Kappa]3*q\:0304*D) -1*(\
\[Kappa]5*q\:0304*D) -1*(\[Kappa]6*q\:0304*D) = 0 (after CBE)\"\>"}], "}"}]}],
  SequenceForm[
  "Continuous ODE: ", {
   "B' = -1*(\[Kappa]1*q\:0304*B) -1*(\[Kappa]3*q\:0304*B) \
+1*(\[Kappa]4*q\:0304*B) +1*(\[Kappa]5*q\:0304*B) = 0 (after CBE)", 
    "C' = +1*(\[Kappa]1*q\:0304*C) -1*(\[Kappa]2*q\:0304*C) \
-1*(\[Kappa]4*q\:0304*C) +1*(\[Kappa]6*q\:0304*C) = 0 (after CBE)", 
    "D' = +1*(\[Kappa]2*q\:0304*D) +1*(\[Kappa]3*q\:0304*D) \
-1*(\[Kappa]5*q\:0304*D) -1*(\[Kappa]6*q\:0304*D) = 0 (after CBE)"}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.959929711712248*^9, 3.959929882935876*^9, 3.9599301816943336`*^9, 
   3.9599400518864875`*^9, 3.959940091390383*^9, 3.959940238070239*^9, 
   3.959941407893716*^9, {3.9599418311996365`*^9, 3.959941860289914*^9}},
 CellLabel->
  "During evaluation of \
In[290]:=",ExpressionUUID->"b045f6ae-a499-4891-a22c-1e23179b6337"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Poisson parameter: \"\>", 
   "\[InvisibleSpace]", "\<\"\[Kappa]\:2084/\[Kappa]\:2082 (from complex \
balance, w terms cancel)\"\>"}],
  SequenceForm[
  "Poisson parameter: ", 
   "\[Kappa]\:2084/\[Kappa]\:2082 (from complex balance, w terms cancel)"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.959929711712248*^9, 3.959929882935876*^9, 3.9599301816943336`*^9, 
   3.9599400518864875`*^9, 3.959940091390383*^9, 3.959940238070239*^9, 
   3.959941407893716*^9, {3.9599418311996365`*^9, 3.959941860355613*^9}},
 CellLabel->
  "During evaluation of \
In[290]:=",ExpressionUUID->"0fa69947-77d7-4326-a660-6e944e7a304d"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{708.8571428571428, 371.1428571428571},
WindowMargins->{{Automatic, -10.285714285714334`}, {-15, Automatic}},
FrontEndVersion->"13.3 for Microsoft Windows (64-bit) (June 3, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"0a2573fe-70cd-44a5-a9c4-686f619f38f3"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 33553, 782, 2616, "Input",ExpressionUUID->"27c6ce13-724c-4d12-bcac-1caba2095556"],
Cell[CellGroupData[{
Cell[34158, 808, 398, 7, 22, "Print",ExpressionUUID->"c16573cf-4404-411f-877e-cb84fc7baac8"],
Cell[34559, 817, 702, 16, 22, "Print",ExpressionUUID->"0a8fab3e-3066-4742-ac2a-e38362185343"],
Cell[35264, 835, 667, 15, 22, "Print",ExpressionUUID->"715b65a1-a4a4-494b-8d7c-ab354dea6aff"],
Cell[35934, 852, 665, 16, 22, "Print",ExpressionUUID->"52d10561-3f60-4423-aedd-2113f02d3620"],
Cell[36602, 870, 583, 12, 22, "Print",ExpressionUUID->"82510cf4-fbde-4488-a594-1bcc6a0a4d83"],
Cell[37188, 884, 377, 7, 22, "Print",ExpressionUUID->"112bf1e2-5d4b-4a68-bbba-20092d2a5828"],
Cell[37568, 893, 407, 7, 22, "Print",ExpressionUUID->"75ee001e-db21-498a-97b8-472e8bf66984"],
Cell[37978, 902, 692, 16, 22, "Print",ExpressionUUID->"df3d343f-68d3-4290-8a7e-90fac9b5f830"],
Cell[38673, 920, 706, 16, 22, "Print",ExpressionUUID->"58afa3dd-dfbb-4043-8a49-add9f67ea7ca"],
Cell[39382, 938, 671, 16, 22, "Print",ExpressionUUID->"a7b40267-ecd7-4849-9d0a-76fcf1b6bc2c"],
Cell[40056, 956, 648, 15, 22, "Print",ExpressionUUID->"6311eeee-ad52-452c-8da1-ee7e36208a8e"],
Cell[40707, 973, 377, 7, 22, "Print",ExpressionUUID->"7529f4f2-ce48-44e0-a45b-1781edea1827"],
Cell[41087, 982, 403, 7, 22, "Print",ExpressionUUID->"30d2bdfe-d4a9-4945-93f0-60b42d395986"],
Cell[41493, 991, 864, 20, 22, "Print",ExpressionUUID->"026739a0-a489-4efa-9aa3-c2549d3ae37e"],
Cell[42360, 1013, 974, 21, 22, "Print",ExpressionUUID->"4e1ba119-fef7-401b-8665-47b1cd0bddbb"],
Cell[43337, 1036, 1363, 25, 58, "Print",ExpressionUUID->"b045f6ae-a499-4891-a22c-1e23179b6337"],
Cell[44703, 1063, 674, 15, 22, "Print",ExpressionUUID->"0fa69947-77d7-4326-a660-6e944e7a304d"]
}, Open  ]]
}, Open  ]]
}
]
*)

